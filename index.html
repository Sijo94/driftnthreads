<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>DRIFT N THREADS | Future Fashion</title>
    
    <!-- 1. Load Tailwind CSS (Styling) -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- 2. Load React (The Engine) -->
    <script crossorigin src="https://unpkg.com/react@18.2.0/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18.2.0/umd/react-dom.production.min.js"></script>
    
    <!-- 3. Load Babel (Translator for JSX) -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- 4. Load Three.js (3D Engine) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <!-- 5. Load OrbitControls (Interaction) -->
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    
    <!-- Custom Fonts -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Syne:wght@400;500;700;800;900&family=Italiana&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@100;400;700&display=swap');
        
        body { 
            font-family: 'Inter', sans-serif; 
            background-color: #050505; 
            color: #E5E5E5; 
            -webkit-font-smoothing: antialiased;
            overflow-x: hidden;
            overscroll-behavior-y: none;
        }
        * { -webkit-tap-highlight-color: transparent; box-sizing: border-box; }
        
        .font-syne { font-family: 'Syne', sans-serif; }
        .font-luxury { font-family: 'Italiana', serif; }
        .font-hud { font-family: 'JetBrains Mono', monospace; }

        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        .custom-scrollbar::-webkit-scrollbar { height: 4px; width: 4px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: #0A0A0A; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #333; border-radius: 2px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #555; }

        @keyframes scan {
            0% { top: 0%; opacity: 0; }
            15% { opacity: 1; }
            85% { opacity: 1; }
            100% { top: 100%; opacity: 0; }
        }
        .animate-scan { animation: scan 3s linear infinite; }

        .animate-fade-in-up { animation: fadeInUp 0.8s ease-out forwards; }
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        
        .animate-fade-in-down { animation: fadeInDown 0.5s ease-out forwards; }
        @keyframes fadeInDown { from { opacity: 0; transform: translateY(-20px); } to { opacity: 1; transform: translateY(0); } }

        .animate-shake { animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both; }
        @keyframes shake { 10%, 90% { transform: translateX(-1px); } 20%, 80% { transform: translateX(2px); } }

        input[type=range] { -webkit-appearance: none; background: transparent; height: 2px; width: 100%; background: #333; border-radius: 2px; cursor: pointer; }
        input[type=range]::-webkit-slider-thumb { -webkit-appearance: none; height: 16px; width: 16px; border-radius: 50%; background: #ffffff; cursor: pointer; margin-top: -7px; border: 2px solid #000; transition: transform 0.1s; }
        input[type=range]::-webkit-slider-thumb:active { transform: scale(1.2); }
        
        input[type="color"] { -webkit-appearance: none; border: none; width: 32px; height: 32px; border-radius: 50%; padding: 0; overflow: hidden; }
        input[type="color"]::-webkit-color-swatch-wrapper { padding: 0; }
        input[type="color"]::-webkit-color-swatch { border: none; }
        
        .safe-area-pb { padding-bottom: env(safe-area-inset-bottom); }
        .text-stroke { -webkit-text-stroke: 1px rgba(255,255,255,0.2); color: transparent; }
    </style>
</head>
<body class="overflow-x-hidden">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- CONSTANTS ---
        const SITE_CONFIG = {
            brandName: "DRIFT N THREADS",
            currency: "$",
            logoUrl: "https://i.postimg.cc/k5jqcK8y/Untitled-design.png",
            brandFontImage: "4 white.png", 
            formEndpoint: "https://formsubmit.co/jibinchacko609@gmail.com"
        };

        const LOADING_IMAGES = [
            "https://images.unsplash.com/photo-1529139574466-a302d2052505?q=80&w=1200&auto=format&fit=crop", 
            "https://images.unsplash.com/photo-1509631179647-0177331693ae?q=80&w=1200&auto=format&fit=crop", 
            "https://images.unsplash.com/photo-1539109136881-3be0616acf4b?q=80&w=1200&auto=format&fit=crop", 
            "https://images.unsplash.com/photo-1617137984095-74e4e5e3613f?q=80&w=1200&auto=format&fit=crop", 
            "https://images.unsplash.com/photo-1483985988355-763728e1935b?q=80&w=1200&auto=format&fit=crop"
        ];

        const PRODUCTS = [
            { id: 1, name: "Drift Graphic Tee 01", price: 45.00, category: "women", image: "https://i.postimg.cc/N0RB937h/05bf2232-b548-4019-b5c2-ceda16784627.png", badge: "BESTSELLER", desc: "Premium cotton tee featuring abstract digital art.", stats: { thermal: 40, durability: 85, flex: 90 } },
            { id: 2, name: "Drift Graphic Hoodie", price: 89.50, category: "men", image: "https://i.postimg.cc/XJvfjGPL/6b3e125a-da12-4bd6-b3e9-b286b4b23c75.png", badge: "NEW", desc: "Oversized hoodie with signature back print.", stats: { thermal: 90, durability: 95, flex: 70 } },
            { id: 3, name: "Urban Tech Hoodie", price: 110.00, category: "men", image: "https://i.postimg.cc/J48ypyzF/3e8910aa-acbc-4d74-b0c6-6b203f49f8dd.jpg", badge: "NEW", desc: "Technical fleece for urban exploration.", stats: { thermal: 85, durability: 80, flex: 85 } },
            { id: 4, name: "Drift Cargo Series", price: 95.00, category: "men", image: "https://i.postimg.cc/xC0QpHd4/mockup-out-1.jpg", badge: "LIMITED", desc: "Heavyweight cotton mockneck.", stats: { thermal: 70, durability: 100, flex: 50 } },
            { id: 5, name: "Drift Graphic Tee 02", price: 45.00, category: "women", image: "https://i.postimg.cc/Zq0fj5P5/61927449-9442-41b9-b701-2f2800020a51.png", badge: "XMAS SPECIAL", desc: "Limited edition holiday graphic.", stats: { thermal: 40, durability: 80, flex: 90 } },
            { id: 6, name: "Drift Graphic Tee 03", price: 45.00, category: "men", image: "https://i.postimg.cc/GmVvhyq3/f12d873b-a780-47de-b179-e5858c37c616.png", badge: "GIFT", desc: "Soft-touch cotton with minimal branding.", stats: { thermal: 45, durability: 85, flex: 95 } },
            { id: 7, name: "Essential Oversized Tee", price: 55.00, category: "men", image: "https://images.unsplash.com/photo-1583743814966-8936f5b7be1a?auto=format&fit=crop&q=80&w=600", badge: "NEW", desc: "Heavyweight structure with a relaxed, boxy fit. The ultimate essential.", stats: { thermal: 40, durability: 90, flex: 85 } },
            { id: 8, name: "Vintage Wash Tee", price: 50.00, category: "women", image: "https://images.unsplash.com/photo-1503342217505-b0a15ec3261c?auto=format&fit=crop&q=80&w=600", badge: "NEW", desc: "Soft, lived-in fabric with a perfectly worn finish.", stats: { thermal: 35, durability: 80, flex: 95 } },
            { id: 9, name: "Mini Drift Hoodie", price: 65.00, category: "kids", image: "https://images.unsplash.com/photo-1519238806101-512515a20b1c?q=80&w=800&auto=format&fit=crop", badge: "YOUTH", desc: "Scaled down street style for the next generation.", stats: { thermal: 85, durability: 95, flex: 90 } },
            { id: 10, name: "Junior Graphic Tee", price: 35.00, category: "kids", image: "https://images.unsplash.com/photo-1519457431-44ccd64a579b?q=80&w=800&auto=format&fit=crop", badge: "YOUTH", desc: "Durable cotton tee for everyday play.", stats: { thermal: 40, durability: 90, flex: 95 } },
        ];

        // --- ICONS ---
        const IconBase = ({ d, className, ...props }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round" className={className} {...props}>{d}</svg>
        );
        const ShoppingBag = (props) => <IconBase d={<><path d="M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z"/><path d="M3 6h18"/><path d="M16 10a4 4 0 0 1-8 0"/></>} {...props} />;
        const Search = (props) => <IconBase d={<><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></>} {...props} />;
        const Menu = (props) => <IconBase d={<><line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/></>} {...props} />;
        const X = (props) => <IconBase d={<><path d="M18 6 6 18"/><path d="m6 6 12 12"/></>} {...props} />;
        const ArrowRight = (props) => <IconBase d={<><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></>} {...props} />;
        const Check = (props) => <IconBase d={<><polyline points="20 6 9 17 4 12" /></>} {...props} />;
        const AlertOctagon = (props) => <IconBase d={<><polygon points="7.86 2 16.14 2 22 7.86 22 16.14 16.14 22 7.86 22 2 16.14 2 7.86 7.86 2" /><line x1="12" y1="8" x2="12" y2="12" /><line x1="12" y1="16" x2="12.01" y2="16" /></>} {...props} />;
        const Lock = (props) => <IconBase d={<><rect x="3" y="11" width="18" height="11" rx="2" ry="2" /><path d="M7 11V7a5 5 0 0 1 10 0v4" /></>} {...props} />;
        const Heart = (props) => <IconBase d={<path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z" />} {...props} />;
        const Zap = (props) => <IconBase d={<polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2" />} {...props} />;
        const Snowflake = (props) => <IconBase d={<><path d="M2 12h20"/><path d="M12 2v20"/><path d="m20 2-7.5 7.5"/><path d="m4 2 7.5 7.5"/><path d="m20 22-7.5-7.5"/><path d="m4 22 7.5-7.5"/></>} {...props} />;
        const Truck = (props) => <IconBase d={<><rect x="1" y="3" width="15" height="13" /><polygon points="16 8 20 8 23 11 23 16 16 16 8" /><circle cx="5.5" cy="18.5" r="2.5" /><circle cx="18.5" cy="18.5" r="2.5" /></>} {...props} />;
        const Database = (props) => <IconBase d={<><ellipse cx="12" cy="5" rx="9" ry="3" /><path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3" /><path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5" /></>} {...props} />;
        const Crown = (props) => <IconBase d={<path d="m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14" />} {...props} />;
        const Shoe = (props) => <IconBase d={<path d="M4 14.9A5 5 0 0 1 9 10h6v-2h-3a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h6.6L22 10.4v8.1a2 2 0 0 1-2 2H4a2 2 0 0 1 0-4z" />} {...props} />;
        const CreditCard = (props) => <IconBase d={<><rect x="2" y="5" width="20" height="14" rx="2" /><line x1="2" y1="10" x2="22" y2="10" /></>} {...props} />;
        const Banknote = (props) => <IconBase d={<><rect width="20" height="12" x="2" y="6" rx="2" /><circle cx="12" cy="12" r="2" /><path d="M6 12h.01M18 12h.01" /></>} {...props} />;
        const Palette = (props) => <IconBase d={<><circle cx="13.5" cy="6.5" r=".5"/><circle cx="17.5" cy="10.5" r=".5"/><circle cx="8.5" cy="7.5" r=".5"/><circle cx="6.5" cy="12.5" r=".5"/><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z"/></>} {...props} />;
        const Upload = (props) => <IconBase d={<><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></>} {...props} />;
        const Cpu = (props) => <IconBase d={<><rect x="4" y="4" width="16" height="16" rx="2" ry="2" /><rect x="9" y="9" width="6" height="6" /><line x1="9" y1="1" x2="9" y2="4" /><line x1="15" y1="1" x2="15" y2="4" /><line x1="9" y1="20" x2="9" y2="23" /><line x1="15" y1="20" x2="15" y2="23" /><line x1="20" y1="9" x2="23" y2="9" /><line x1="20" y1="14" x2="23" y2="14" /><line x1="1" y1="9" x2="4" y2="9" /><line x1="1" y1="14" x2="4" y2="14" /></>} {...props} />;
        const Sliders = (props) => <IconBase d={<><line x1="4" y1="21" x2="4" y2="14" /><line x1="4" y1="10" x2="4" y2="3" /><line x1="12" y1="21" x2="12" y2="12" /><line x1="12" y1="8" x2="12" y2="3" /><line x1="20" y1="21" x2="20" y2="16" /><line x1="20" y1="12" x2="20" y2="3" /><line x1="1" y1="14" x2="7" y2="14" /><line x1="9" y1="8" x2="15" y2="8" /><line x1="17" y1="16" x2="23" y2="16" /></>} {...props} />;
        const Wand = (props) => <IconBase d={<><path d="M15 4V2" /><path d="M15 16v-2" /><path d="M8 9h2" /><path d="M20 9h2" /><path d="M17.8 11.8 19 13" /><path d="M15 9h0" /><path d="M17.8 6.2 19 5" /><path d="m3 21 9-9" /><path d="M12.2 6.2 11 5" /></>} {...props} />;
        const Box = (props) => <IconBase d={<><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z" /><polyline points="3.27 6.96 12 12.01 20.73 6.96" /><line x1="12" y1="22.08" x2="12" y2="12" /></>} {...props} />;
        const AppleLogo = (props) => (
            <svg viewBox="0 0 384 512" fill="currentColor" {...props}>
                <path d="M318.7 268.7c-.2-36.7 16.4-64.4 50-84.8-18.8-26.9-47.2-41.7-84.7-44.6-35.5-2.8-74.3 20.7-88.5 20.7-15 0-49.4-19.7-76.4-19.7C63.3 141.2 4 184.8 4 273.5q0 39.3 14.4 81.2c12.8 36.7 59 126.7 107.2 125.2 25.2-.6 43-17.9 75.8-17.9 31.8 0 48.3 17.9 76.4 17.9 48.6-.7 90.4-82.5 102.6-119.3-65.2-30.7-61.7-90-61.7-91.9zm-56.6-164.2c27.3-32.4 24.8-61.9 24-72.5-24.1 1.4-52 16.4-67.9 34.9-17.5 19.8-27.8 44.3-25.6 71.9 26.1 2 52.3-11.4 69.5-34.3z"/>
            </svg>
        );

        const preloadImages = (srcs) => {
            return Promise.all(srcs.map((src) => {
                return new Promise((resolve) => {
                    const img = new Image();
                    img.src = src;
                    img.onload = resolve;
                    img.onerror = resolve;
                });
            }));
        };

        const ThreeDViewer = ({ config, showGrid = false, showWireframe = false }) => {
            const mountRef = useRef(null);
            const sceneRef = useRef(null);
            const garmentRef = useRef(null); 
            const graphicMeshRef = useRef(null); 
            const controlsRef = useRef(null); 
            const gridHelperRef = useRef(null);

            useEffect(() => {
                if (!mountRef.current) return;
                
                const scene = new THREE.Scene();
                sceneRef.current = scene;

                const camera = new THREE.PerspectiveCamera(45, mountRef.current.clientWidth / mountRef.current.clientHeight, 0.1, 1000);
                const isMobile = window.innerWidth < 768;
                camera.position.z = isMobile ? 6.5 : 4.5;
                camera.position.y = 0.5;

                const renderer = new THREE.WebGLRenderer({ alpha: true, antialias: true });
                renderer.setSize(mountRef.current.clientWidth, mountRef.current.clientHeight);
                renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2)); 
                mountRef.current.appendChild(renderer.domElement);

                const controls = new THREE.OrbitControls(camera, renderer.domElement);
                controls.enableDamping = true; 
                controls.dampingFactor = 0.05;
                controls.enableZoom = true; 
                controls.enablePan = false; 
                controls.minPolarAngle = Math.PI / 2 - 0.5; 
                controls.maxPolarAngle = Math.PI / 2 + 0.5;
                controlsRef.current = controls;

                const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
                scene.add(ambientLight);
                const dirLight = new THREE.DirectionalLight(0xffffff, 0.8);
                dirLight.position.set(2, 5, 5);
                scene.add(dirLight);
                const backLight = new THREE.DirectionalLight(0xffffff, 0.3);
                backLight.position.set(-2, 5, -5);
                scene.add(backLight);
                
                const garmentGroup = new THREE.Group();
                garmentRef.current = garmentGroup;
                scene.add(garmentGroup);

                const gridHelper = new THREE.GridHelper(10, 10, 0x444444, 0x222222);
                gridHelper.position.y = -2.2;
                gridHelper.visible = showGrid;
                gridHelperRef.current = gridHelper;
                scene.add(gridHelper);

                let frameId;
                const animate = () => {
                    frameId = requestAnimationFrame(animate);
                    if (controlsRef.current) controlsRef.current.update();
                    renderer.render(scene, camera);
                };
                animate();

                const handleResize = () => {
                    if (!mountRef.current) return;
                    camera.aspect = mountRef.current.clientWidth / mountRef.current.clientHeight;
                    camera.updateProjectionMatrix();
                    renderer.setSize(mountRef.current.clientWidth, mountRef.current.clientHeight);
                };
                window.addEventListener('resize', handleResize);

                return () => {
                    cancelAnimationFrame(frameId);
                    window.removeEventListener('resize', handleResize);
                    if (mountRef.current && renderer.domElement) {
                        mountRef.current.removeChild(renderer.domElement);
                    }
                    if(controlsRef.current) controlsRef.current.dispose();
                    renderer.dispose();
                };
            }, []);

            useEffect(() => {
                if(gridHelperRef.current) gridHelperRef.current.visible = showGrid;
            }, [showGrid]);

            useEffect(() => {
                if (!garmentRef.current) return;
                while(garmentRef.current.children.length > 0){ garmentRef.current.remove(garmentRef.current.children[0]); }
                
                const material = new THREE.MeshStandardMaterial({ 
                    color: config.color || 0xffffff, 
                    roughness: 0.7, 
                    metalness: 0.1,
                    side: THREE.DoubleSide,
                    wireframe: showWireframe
                });

                const isHoodie = config.type === 'HOODIE';
                const isOversized = config.type === 'OVERSIZED';
                const torsoH = isHoodie ? 2.2 : 2.0;
                const torsoR = isOversized ? 0.85 : 0.7;
                const torso = new THREE.Mesh(new THREE.CylinderGeometry(torsoR, torsoR, torsoH, 32), material);
                torso.scale.set(1.2, 1, 0.7); 
                garmentRef.current.add(torso);
                const sleeveLen = isHoodie ? 1.8 : (isOversized ? 1.2 : 0.8);
                const sleeveR = isOversized ? 0.35 : 0.3;
                const sleeveGeo = new THREE.CylinderGeometry(sleeveR, sleeveR * 0.8, sleeveLen, 32);
                const leftArm = new THREE.Mesh(sleeveGeo, material);
                leftArm.position.set(isOversized ? -1.0 : -0.9, 0.5, 0);
                leftArm.rotation.z = Math.PI / (isOversized ? 3 : 4);
                garmentRef.current.add(leftArm);
                const rightArm = new THREE.Mesh(sleeveGeo, material);
                rightArm.position.set(isOversized ? 1.0 : 0.9, 0.5, 0);
                rightArm.rotation.z = -Math.PI / (isOversized ? 3 : 4);
                garmentRef.current.add(rightArm);
                if (isHoodie) {
                    const hood = new THREE.Mesh(new THREE.SphereGeometry(0.7, 32, 32, 0, Math.PI * 2, 0, Math.PI/2), material);
                    hood.position.set(0, 1, 0);
                    hood.rotation.x = Math.PI;
                    hood.scale.set(1, 1, 0.8);
                    garmentRef.current.add(hood);
                    const pocket = new THREE.Mesh(new THREE.CylinderGeometry(0.4, 0.4, 0.4, 32, 1, false, 0, Math.PI), material);
                    pocket.position.set(0, -0.5, 0.36);
                    pocket.rotation.z = Math.PI; 
                    pocket.scale.set(1, 1, 0.5); 
                    garmentRef.current.add(pocket);
                } else {
                    const collar = new THREE.Mesh(new THREE.TorusGeometry(0.3, 0.05, 16, 50), material);
                    collar.position.set(0, 1, 0);
                    collar.rotation.x = Math.PI / 2;
                    garmentRef.current.add(collar);
                }
                const graphicGeo = new THREE.PlaneGeometry(1, 1);
                const graphicMat = new THREE.MeshStandardMaterial({ 
                    transparent: true, opacity: 0, depthTest: true, depthWrite: false, roughness: 0.5, metalness: 0 
                });
                const graphicMesh = new THREE.Mesh(graphicGeo, graphicMat);
                graphicMesh.renderOrder = 999;
                graphicMeshRef.current = graphicMesh;
                garmentRef.current.add(graphicMesh);
            }, [config.type, showWireframe]);

            useEffect(() => {
                if (!garmentRef.current) return;
                garmentRef.current.children.forEach(child => {
                    if (child !== graphicMeshRef.current && child.material) {
                        child.material.color.set(config.color);
                        child.material.wireframe = showWireframe;
                    }
                });
            }, [config.color, config.type, showWireframe]);

            useEffect(() => {
                if (!graphicMeshRef.current) return;
                if (!config.graphic) {
                    graphicMeshRef.current.material.opacity = 0;
                    graphicMeshRef.current.material.map = null;
                } else {
                    new THREE.TextureLoader().load(config.graphic, (texture) => {
                        if(graphicMeshRef.current) {
                            graphicMeshRef.current.material.map = texture;
                            graphicMeshRef.current.material.opacity = 1;
                            graphicMeshRef.current.material.needsUpdate = true;
                        }
                    });
                }
                const x = ((config.graphicPos.x - 50) / 50) * 0.4; 
                let yBase = 0.2;
                if(config.type === 'HOODIE') yBase = 0.3; 
                const y = ((config.graphicPos.y - 50) / 50) * -0.6; 
                let zOffset = 0.36;
                if(config.type === 'HOODIE') zOffset = 0.45;
                if(config.type === 'OVERSIZED') zOffset = 0.45;
                
                if(graphicMeshRef.current) {
                    graphicMeshRef.current.position.set(x, y + yBase, zOffset);
                    graphicMeshRef.current.scale.set(config.graphicScale, config.graphicScale, 1);
                    graphicMeshRef.current.rotation.z = -config.graphicRotation * (Math.PI / 180);
                }
            }, [config.graphic, config.graphicPos, config.graphicScale, config.graphicRotation, config.type]);

            return <div ref={mountRef} className="w-full h-full cursor-move touch-none" />;
        };

        const CustomizerStudio = ({ addToCart, goBack }) => {
            const [activeCategory, setActiveCategory] = useState("MEN");
            const [activeProductType, setActiveProductType] = useState("TEE");
            const [color, setColor] = useState("#FFFFFF");
            const [graphic, setGraphic] = useState(null);
            const [graphicPos, setGraphicPos] = useState({ x: 50, y: 40 });
            const [graphicScale, setGraphicScale] = useState(1);
            const [graphicRotation, setGraphicRotation] = useState(0);
            const [size, setSize] = useState("L");
            const [showGrid, setShowGrid] = useState(true);
            const [showWireframe, setShowWireframe] = useState(false);
            const [activeMobileTab, setActiveMobileTab] = useState('MAIN'); 

            const ICONS = {
                TEE: "https://i.postimg.cc/Vv1vdpfJ/2.png",
                HOODIE: "https://i.postimg.cc/zf5CYtWX/1.png",
                OVERSIZED: "https://i.postimg.cc/VNDCQYmb/3.png"
            };

            const BASE_PRODUCTS = {
                TEE: {
                    image: "https://images.unsplash.com/photo-1521572163474-6864f9cf17ab?q=80&w=800&auto=format&fit=crop",
                    price: 45,
                    icon: <img src={ICONS.TEE} alt="Tee" className="w-8 h-8 object-contain opacity-70 group-hover:opacity-100 group-hover:scale-110 transition-all duration-300" />
                },
                HOODIE: {
                    image: "https://images.unsplash.com/photo-1556905055-8f358a7a47b2?q=80&w=800&auto=format&fit=crop", 
                    price: 85,
                    icon: <img src={ICONS.HOODIE} alt="Hoodie" className="w-8 h-8 object-contain opacity-70 group-hover:opacity-100 group-hover:scale-110 transition-all duration-300" />
                },
                OVERSIZED: {
                    image: "https://images.unsplash.com/photo-1576566588028-4147f3842f27?q=80&w=800&auto=format&fit=crop",
                    price: 55,
                    icon: <img src={ICONS.OVERSIZED} alt="Oversized" className="w-8 h-8 object-contain opacity-70 group-hover:opacity-100 group-hover:scale-110 transition-all duration-300" />
                }
            };

            const PRESET_COLORS = ["#FFFFFF", "#000000", "#DC2626", "#2563EB", "#16A34A", "#FBBF24", "#525252", "#E11D48"];

            const handleImageUpload = (e) => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (e) => setGraphic(e.target.result);
                    reader.readAsDataURL(file);
                }
            };

            const calculatePrice = () => {
                let base = BASE_PRODUCTS[activeProductType].price;
                if (graphic) base += 10;
                if (size === '2XL' || size === '3XL') base += 5;
                return base;
            };

            const handleAddToCart = () => {
                addToCart({
                    id: `CUST-${Date.now()}`,
                    name: `Custom ${activeCategory} ${activeProductType}`,
                    price: calculatePrice(),
                    category: "custom",
                    image: BASE_PRODUCTS[activeProductType].image,
                    selectedSize: size, 
                    customConfig: { color, graphic, category: activeCategory, type: activeProductType, graphicPos, graphicScale }
                });
                goBack();
            };

            const ProSlider = ({ label, value, min, max, step, onChange, unit = "" }) => (
                <div className="mb-4">
                    <div className="flex justify-between items-center mb-1">
                        <label className="text-[9px] font-mono text-gray-500 uppercase tracking-wider">{label}</label>
                        <span className="text-[9px] font-mono text-red-400 bg-red-900/10 px-1 border border-red-900/20">{value}{unit}</span>
                    </div>
                    <div className="flex items-center gap-2">
                        <input type="range" min={min} max={max} step={step} value={value} onChange={onChange} className="flex-1 h-1 bg-zinc-700 rounded-none appearance-none cursor-pointer [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-2 [&::-webkit-slider-thumb]:h-2 [&::-webkit-slider-thumb]:bg-red-500 [&::-webkit-slider-thumb]:rounded-none" />
                    </div>
                </div>
            );

            const PropertiesContent = () => (
                <div className="space-y-6">
                    <div className="bg-[#111] p-3 rounded-sm border border-white/5">
                        <div className="grid grid-cols-2 gap-2 text-[9px] font-mono text-gray-500 uppercase">
                            <span>Target</span><span className="text-white text-right">{activeCategory}</span>
                            <span>Base</span><span className="text-white text-right">{activeProductType}</span>
                        </div>
                    </div>
                    <div>
                        <div className="flex items-center justify-between mb-3 border-b border-white/5 pb-2">
                            <span className="text-[10px] font-bold text-gray-400 uppercase font-mono">Texture Map</span>
                            <span className={`w-2 h-2 rounded-full ${graphic ? 'bg-green-500' : 'bg-gray-700'}`}></span>
                        </div>
                        <label className="w-full cursor-pointer bg-[#111] border border-dashed border-white/10 hover:border-red-500 hover:text-red-500 text-gray-500 py-4 rounded-sm flex flex-col items-center justify-center gap-2 text-[9px] font-mono uppercase transition-all mb-4">
                            <Upload size={14} /><span>{graphic ? 'Replace Source' : 'Import Texture'}</span>
                            <input type="file" accept="image/*" className="hidden" onChange={handleImageUpload} />
                        </label>
                        {graphic && (
                            <div className="animate-fade-in-up">
                                <ProSlider label="Position X" value={graphicPos.x} min={0} max={100} step={1} unit="%" onChange={(e) => setGraphicPos({...graphicPos, x: parseInt(e.target.value)})} />
                                <ProSlider label="Position Y" value={graphicPos.y} min={0} max={100} step={1} unit="%" onChange={(e) => setGraphicPos({...graphicPos, y: parseInt(e.target.value)})} />
                                <ProSlider label="Scale" value={graphicScale} min={0.1} max={3.0} step={0.1} unit="x" onChange={(e) => setGraphicScale(parseFloat(e.target.value))} />
                                <ProSlider label="Rotation" value={graphicRotation} min={0} max={360} step={1} unit="°" onChange={(e) => setGraphicRotation(parseInt(e.target.value))} />
                                <button onClick={() => setGraphic(null)} className="w-full mt-4 py-2 border border-red-900/50 text-red-500 text-[9px] font-mono hover:bg-red-900/20 transition-colors uppercase">Remove Texture</button>
                            </div>
                        )}
                    </div>
                    <div>
                        <div className="flex items-center justify-between mb-3 border-b border-white/5 pb-2"><span className="text-[10px] font-bold text-gray-400 uppercase font-mono">Calibration</span></div>
                        <div className="grid grid-cols-3 gap-2">
                            {['S', 'M', 'L', 'XL', '2XL', '3XL'].map(s => (
                                <button key={s} onClick={() => setSize(s)} className={`py-2 text-[10px] font-mono border rounded-sm transition-all ${size === s ? 'bg-white text-black border-white font-bold' : 'border-white/10 text-gray-500 hover:border-white/30 bg-[#111]'}`}>{s}</button>
                            ))}
                        </div>
                    </div>
                </div>
            );

            const AssetsContent = () => (
                <div className="flex gap-4 overflow-x-auto whitespace-nowrap custom-scrollbar pb-2">
                    <div className="flex gap-2 border-r border-white/5 pr-4 mr-2">
                        {Object.keys(BASE_PRODUCTS).map(type => (
                            <button key={type} onClick={() => setActiveProductType(type)} className={`w-24 h-24 border rounded-sm relative group flex flex-col items-center justify-center gap-2 p-2 transition-all ${activeProductType === type ? 'border-red-500 bg-white/5' : 'border-white/5 hover:border-white/20 bg-[#151515]'}`}>
                                <div className="opacity-70 group-hover:opacity-100 transition-opacity">{BASE_PRODUCTS[type].icon}</div>
                                <span className="text-[9px] font-mono text-gray-500 group-hover:text-white">{type}</span>
                            </button>
                        ))}
                    </div>
                    <div className="flex gap-2 border-r border-white/5 pr-4 mr-2">
                        {['MEN', 'WOMEN', 'KIDS'].map(cat => (
                            <button key={cat} onClick={() => setActiveCategory(cat)} className={`w-20 h-full border rounded-sm flex items-center justify-center text-[10px] font-mono transition-all ${activeCategory === cat ? 'border-red-500 text-white bg-white/5' : 'border-white/5 text-gray-500 hover:border-white/20 bg-[#151515]'}`}>{cat}</button>
                        ))}
                    </div>
                    <div className="flex gap-2">
                        {PRESET_COLORS.map(c => (
                            <button key={c} onClick={() => setColor(c)} className={`w-12 h-full rounded-sm border transition-all ${color === c ? 'border-white scale-105' : 'border-transparent opacity-70 hover:opacity-100'}`} style={{ backgroundColor: c }} />
                        ))}
                        <div className="w-12 h-full bg-[#151515] border border-white/5 rounded-sm flex items-center justify-center relative"><input type="color" value={color} onChange={(e) => setColor(e.target.value)} className="w-full h-full opacity-0 cursor-pointer absolute" /><Palette size={14} className="text-gray-500" /></div>
                    </div>
                </div>
            );

            return (
                <div className="fixed inset-0 z-[200] bg-[#0F0F0F] flex flex-col font-sans animate-fade-in-up text-white overflow-hidden">
                    <div className="h-12 bg-[#050505] border-b border-white/5 flex items-center justify-between px-4 z-40 select-none shrink-0">
                        <div className="flex items-center gap-2 md:gap-6">
                            <div className="flex items-center gap-2 text-white/50"><Cpu size={14} /><span className="text-[10px] font-mono font-bold tracking-widest uppercase">Drift<span className="text-red-600">_OS</span> v2.4</span></div>
                            <div className="hidden md:flex gap-4 text-[10px] font-mono text-gray-400"><span>FILE</span><span>EDIT</span><span>VIEW</span></div>
                        </div>
                        <div className="flex items-center gap-4"><button onClick={goBack} className="text-gray-500 hover:text-red-500 transition-colors p-2"><X size={18}/></button></div>
                    </div>

                    <div className="flex-1 flex overflow-hidden relative">
                        <div className="hidden md:flex w-12 bg-[#0A0A0A] border-r border-white/5 flex-col items-center py-4 gap-4 z-30">
                            {[<Box size={16} />, <Sliders size={16} />, <Database size={16} />, <Cpu size={16} />].map((icon, i) => (
                                <button key={i} className="p-2 text-gray-600 hover:text-white transition-colors">{icon}</button>
                            ))}
                        </div>

                        <div className="flex-1 relative bg-[#111] flex flex-col min-w-0">
                            <div className="absolute top-4 left-4 z-10 flex gap-2">
                                <button onClick={() => setShowGrid(!showGrid)} className={`px-3 py-1 text-[9px] font-mono border rounded-sm transition-colors uppercase ${showGrid ? 'bg-white/10 border-white/20 text-white' : 'bg-transparent border-white/5 text-gray-600'}`}>Grid</button>
                                <button onClick={() => setShowWireframe(!showWireframe)} className={`px-3 py-1 text-[9px] font-mono border rounded-sm transition-colors uppercase ${showWireframe ? 'bg-white/10 border-white/20 text-white' : 'bg-transparent border-white/5 text-gray-600'}`}>Wireframe</button>
                            </div>
                            <div className="flex-1 w-full h-full relative cursor-crosshair">
                                <ThreeDViewer config={{ type: activeProductType, color: color, graphic: graphic, graphicPos: graphicPos, graphicScale: graphicScale, graphicRotation: graphicRotation }} showGrid={showGrid} showWireframe={showWireframe} />
                            </div>
                            
                            <div className="hidden md:flex h-48 bg-[#0A0A0A] border-t border-white/5 flex-col z-20">
                                <div className="h-8 border-b border-white/5 flex items-center px-4"><span className="text-[10px] font-mono font-bold text-gray-400 uppercase">Asset Browser</span></div>
                                <div className="flex-1 p-4"><AssetsContent /></div>
                            </div>
                        </div>

                        <div className="hidden md:flex w-80 bg-[#0A0A0A] border-l border-white/5 flex-col z-30">
                            <div className="p-4 border-b border-white/5"><h3 className="text-[10px] font-mono font-bold text-white uppercase tracking-widest flex items-center gap-2"><Sliders size={12} className="text-red-500" /> Properties</h3></div>
                            <div className="flex-1 overflow-y-auto p-4 custom-scrollbar"><PropertiesContent /></div>
                            <div className="p-4 bg-[#111] border-t border-white/5">
                                <div className="flex justify-between items-center mb-4"><span className="text-gray-300 text-xs font-mono uppercase">Total</span><span className="text-xl font-syne font-bold text-white">{SITE_CONFIG.currency}{calculatePrice().toFixed(2)}</span></div>
                                <button onClick={handleAddToCart} className="w-full bg-red-600 text-white py-3 font-bold text-[10px] uppercase tracking-[0.2em] hover:bg-red-700 transition-all rounded-sm">Initiate Fabrication</button>
                            </div>
                        </div>

                        <div className="md:hidden absolute inset-x-0 bottom-0 z-50 flex flex-col pointer-events-none">
                            <div className={`bg-[#0F0F0F]/95 backdrop-blur-xl border-t border-white/10 transition-all duration-300 pointer-events-auto flex flex-col ${activeMobileTab === 'MAIN' ? 'h-0' : 'h-[50vh]'}`}>
                                {activeMobileTab !== 'MAIN' && (
                                    <>
                                        <div className="flex justify-between items-center p-4 border-b border-white/10">
                                            <span className="text-[10px] font-mono uppercase font-bold text-gray-400">{activeMobileTab}</span>
                                            <button onClick={() => setActiveMobileTab('MAIN')}><X size={16} className="text-white"/></button>
                                        </div>
                                        <div className="flex-1 overflow-y-auto p-4 custom-scrollbar">
                                            {activeMobileTab === 'ASSETS' && <div className="flex flex-col gap-4"><AssetsContent /></div>}
                                            {activeMobileTab === 'PROPERTIES' && <PropertiesContent />}
                                        </div>
                                    </>
                                )}
                            </div>

                            <div className="bg-black border-t border-white/10 p-2 flex items-center justify-between gap-2 pointer-events-auto safe-area-pb">
                                <button onClick={() => setActiveMobileTab('ASSETS')} className={`flex-1 py-3 text-[10px] font-mono uppercase tracking-wider rounded-sm border ${activeMobileTab === 'ASSETS' ? 'bg-white text-black border-white' : 'bg-zinc-900 border-zinc-800 text-gray-400'}`}>Assets</button>
                                <button onClick={() => setActiveMobileTab('PROPERTIES')} className={`flex-1 py-3 text-[10px] font-mono uppercase tracking-wider rounded-sm border ${activeMobileTab === 'PROPERTIES' ? 'bg-white text-black border-white' : 'bg-zinc-900 border-zinc-800 text-gray-400'}`}>Edit</button>
                                <button onClick={handleAddToCart} className="flex-[1.5] py-3 bg-red-600 text-white text-[10px] font-bold uppercase tracking-widest rounded-sm">Add {SITE_CONFIG.currency}{calculatePrice()}</button>
                            </div>
                        </div>

                    </div>
                </div>
            );
        };

        const HolidayBanner = () => (
            <div className="bg-white/5 backdrop-blur-md border-b border-white/10 text-white text-[9px] font-syne font-bold tracking-[0.25em] uppercase py-3 relative z-[70] shadow-sm flex justify-center items-center">
                <div className="flex flex-col md:flex-row space-y-2 md:space-y-0 md:space-x-16 px-4 text-center">
                    <span className="inline-flex items-center justify-center"><span className="text-red-500 mr-3 text-xs">●</span> NEW DROPS FRIDAY</span>
                    <span className="hidden md:inline-flex items-center justify-center"><span className="text-red-500 mr-3 text-xs">●</span> COMPLIMENTARY GIFT WRAPPING</span>
                    <span className="hidden lg:inline-flex items-center justify-center"><span className="text-red-500 mr-3 text-xs">●</span> GLOBAL SHIPPING INCLUDED</span>
                </div>
            </div>
        );

        const InputField = ({ label, name, value, onChange, type = "text", placeholder, required = false }) => (
            <div className="mb-6">
                <label className="block text-[10px] font-bold text-gray-400 tracking-[0.2em] uppercase mb-2 ml-1">{label}</label>
                <input type={type} name={name} value={value} onChange={onChange} placeholder={placeholder} required={required}
                    className="w-full bg-white/5 border border-white/20 rounded-md px-4 py-3 text-white transition-all focus:border-red-600 focus:bg-white/10 outline-none placeholder-gray-600 font-sans text-sm shadow-inner" />
            </div>
        );

        const ProductCard = ({ product, openModal }) => (
            <div className="group cursor-pointer flex flex-col h-full bg-zinc-900/50 border border-white/5 hover:border-red-600/50 transition-all duration-300 rounded-lg overflow-hidden relative" onClick={() => openModal(product)}>
                <div className="relative aspect-[4/5] overflow-hidden">
                     <img src={product.image} alt={product.name} className="w-full h-full object-cover group-hover:scale-110 transition-transform duration-700 opacity-90 group-hover:opacity-100" />
                     {product.badge && <span className="absolute top-2 left-2 bg-red-600 text-white text-[9px] font-bold px-2 py-1 uppercase tracking-wider rounded-sm">{product.badge}</span>}
                     <div className="absolute top-2 right-2 bg-black/50 p-2 rounded-full text-white hover:bg-red-600 transition-colors opacity-0 group-hover:opacity-100"><Heart size={14}/></div>
                     <div className="absolute inset-x-0 bottom-0 bg-white/10 backdrop-blur-md translate-y-full group-hover:translate-y-0 transition-transform duration-300 p-2 flex justify-center gap-2"><span className="text-[10px] text-white font-bold uppercase tracking-widest">Quick View</span></div>
                </div>
                <div className="p-3 flex flex-col flex-1">
                    <h3 className="text-white font-bold text-sm truncate font-syne mb-1">{product.name}</h3>
                    <p className="text-gray-500 text-xs mb-2 capitalize tracking-wide">{product.category}</p>
                    <div className="mt-auto border-t border-white/10 pt-2 flex items-center justify-between">
                        <div className="flex flex-col"><span className="text-white font-bold text-sm">{SITE_CONFIG.currency}{product.price.toFixed(0)}</span><span className="text-[9px] text-red-400 font-mono tracking-wider">TRIBE: {SITE_CONFIG.currency}{(product.price * 0.9).toFixed(0)}</span></div>
                        <button className="bg-white text-black p-2 rounded-full hover:bg-red-600 hover:text-white transition-colors active:scale-90" onClick={(e) => { e.stopPropagation(); openModal(product); }}><ShoppingBag size={14} /></button>
                    </div>
                </div>
            </div>
        );

        const ProductModal = ({ product, close, addToCart, goToCheckout }) => {
            const [size, setSize] = useState(null);
            const [quantity, setQuantity] = useState(1);
            const [height, setHeight] = useState(175);
            const [weight, setWeight] = useState(70);
            const [recommendedSize, setRecommendedSize] = useState(null);
            const [isCalculating, setIsCalculating] = useState(false);

            useEffect(() => {
                setIsCalculating(true);
                const timer = setTimeout(() => {
                    const h = parseInt(height);
                    const w = parseInt(weight);
                    const bmi = w / ((h/100) * (h/100));
                    let rec = 'M';
                    if (w < 55) rec = 'S';
                    else if (w < 70) rec = 'M';
                    else if (w < 82) rec = 'L';
                    else if (w < 95) rec = 'XL';
                    else if (w < 110) rec = '2XL';
                    else rec = '3XL';
                    if (h > 195) {
                        if (rec === 'S' || rec === 'M') rec = 'L'; 
                        else if (rec === 'L') rec = 'XL';
                        else if (rec === 'XL') rec = '2XL';
                    } else if (h > 185) {
                         if (rec === 'S') rec = 'M';
                    }
                    if (bmi > 29 && rec !== '3XL') {
                        if (w > 68 && rec === 'M') rec = 'L';
                        if (w > 80 && rec === 'L') rec = 'XL';
                        if (w > 93 && rec === 'XL') rec = '2XL';
                    }
                    setRecommendedSize(rec);
                    setIsCalculating(false);
                }, 800);
                return () => clearTimeout(timer);
            }, [height, weight]);

            const handleAddToCart = () => { if (size) { for (let i = 0; i < quantity; i++) addToCart({...product, selectedSize: size}); close(); } };
            const handleBuyNow = () => { if (size) { for (let i = 0; i < quantity; i++) addToCart({...product, selectedSize: size}); close(); goToCheckout(); } };

            return (
                <div className="fixed inset-0 z-[100] flex items-center justify-center p-4">
                    <div className="absolute inset-0 bg-black/90 backdrop-blur-xl" onClick={close}></div>
                    <div className="bg-[#0A0A0A] border border-white/10 w-full max-w-5xl max-h-[90vh] overflow-y-auto relative z-10 flex flex-col md:flex-row shadow-2xl animate-fade-in-up rounded-sm">
                        <button onClick={close} className="absolute top-4 right-4 md:top-6 md:right-6 text-white z-50 hover:text-red-500 transition-colors bg-black/50 rounded-full p-1 active:scale-90"><X /></button>
                        <div className="w-full md:w-1/2 h-56 md:h-auto relative bg-zinc-900 overflow-hidden shrink-0"><img src={product.image} className="w-full h-full object-cover relative z-0" /><div className="absolute bottom-4 left-4 bg-black/60 backdrop-blur-md px-3 py-1 text-[10px] text-white font-mono tracking-widest uppercase z-20">Stock: Low</div></div>
                        <div className="w-full md:w-1/2 p-6 md:p-16 flex flex-col justify-center bg-gradient-to-br from-white/5 to-black/80 backdrop-blur-sm">
                            <span className="text-red-600 text-[10px] font-mono tracking-widest mb-2 md:mb-4 uppercase">/ {product.category} Collection</span>
                            <h2 className="font-syne text-2xl md:text-5xl font-bold text-white mb-2 md:mb-4 uppercase leading-tight">{product.name}</h2>
                            <p className="text-xl md:text-2xl text-white font-light mb-6 font-syne">{SITE_CONFIG.currency}{product.price.toFixed(2)}</p>
                            <p className="text-gray-400 text-xs md:text-sm leading-relaxed mb-8 font-light border-l border-red-600 pl-4">{product.desc}</p>
                            <div className="mb-8">
                                <div className="flex justify-between items-center mb-4"><span className="text-gray-500 text-[10px] font-bold tracking-widest uppercase">Select Size</span><span className="text-white text-[10px] underline cursor-pointer hover:text-red-500">Size Guide</span></div>
                                <div className="flex flex-wrap gap-3 mb-6">
                                    {['S', 'M', 'L', 'XL', '2XL', '3XL'].map((s) => (
                                        <button key={s} onClick={() => setSize(s)} className={`relative w-12 h-12 md:w-14 md:h-14 flex items-center justify-center text-xs font-bold transition-all duration-300 border ${size === s ? 'bg-white text-black border-white' : 'bg-transparent text-gray-500 border-white/10 hover:border-white hover:text-white'} ${recommendedSize === s && !isCalculating ? 'ring-1 ring-red-500 ring-offset-2 ring-offset-[#0A0A0A]' : ''} active:scale-95`}>
                                            {s} {recommendedSize === s && !isCalculating && <span className="absolute -top-1 -right-1 flex h-2 w-2"><span className="animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"></span><span className="relative inline-flex rounded-full h-2 w-2 bg-red-500"></span></span>}
                                        </button>
                                    ))}
                                </div>
                                <div className="bg-[#050505] border border-white/10 p-5 relative overflow-hidden group">
                                     <div className="absolute top-0 right-0 p-2 opacity-30"><div className="flex gap-1"><div className="w-1 h-1 bg-red-500 rounded-full"></div><div className="w-1 h-1 bg-red-500 rounded-full"></div><div className="w-1 h-1 bg-red-500 rounded-full"></div></div></div>
                                    <h3 className="text-white font-syne text-xs uppercase tracking-widest mb-4 flex items-center gap-2"><span className="text-red-500 text-lg animate-pulse">///</span> AI Size Calculator</h3>
                                    <div className="flex gap-4 mb-4">
                                        <div className="flex-1 relative"><label className="text-[9px] text-gray-500 block mb-2 tracking-wider font-mono">HEIGHT (CM)</label><input type="number" value={height} onChange={(e) => setHeight(e.target.value)} placeholder="175" className="w-full bg-white/5 border border-white/10 text-white p-3 focus:border-red-600 focus:bg-white/10 outline-none font-mono text-sm placeholder-gray-700 transition-colors mb-2" /><input type="range" min="150" max="220" value={height} onChange={(e) => setHeight(e.target.value)} className="w-full h-1 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-red-600 hover:accent-red-500" /></div>
                                        <div className="flex-1 relative"><label className="text-[9px] text-gray-500 block mb-2 tracking-wider font-mono">WEIGHT (KG)</label><input type="number" value={weight} onChange={(e) => setWeight(e.target.value)} placeholder="70" className="w-full bg-white/5 border border-white/10 text-white p-3 focus:border-red-600 focus:bg-white/10 outline-none font-mono text-sm placeholder-gray-700 transition-colors mb-2" /><input type="range" min="40" max="160" value={weight} onChange={(e) => setWeight(e.target.value)} className="w-full h-1 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-red-600 hover:accent-red-500" /></div>
                                    </div>
                                    <div className={`transition-all duration-300 border-t border-white/5 pt-4`}>
                                        <div className="flex items-center justify-between">
                                            <div className="flex flex-col">
                                                <span className="text-[9px] text-gray-500 font-mono uppercase">System Analysis</span>
                                                <span className="text-white font-syne font-bold text-lg tracking-wider flex items-center gap-2">
                                                    {isCalculating ? (
                                                        <span className="text-red-500 animate-pulse font-mono text-xs">ANALYZING BIOMETRICS...</span>
                                                    ) : (
                                                        <>BEST FIT: <span className="text-red-500">{recommendedSize}</span></>
                                                    )}
                                                </span>
                                            </div>
                                            {!isCalculating && recommendedSize && <button onClick={() => setSize(recommendedSize)} className="bg-red-600 text-white px-5 py-2 text-[10px] font-bold uppercase tracking-[0.2em] hover:bg-red-700 transition-colors shadow-[0_0_20px_rgba(220,38,38,0.4)] flex items-center gap-2 active:scale-95">Select <Check className="w-3 h-3" /></button>}
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div className="flex gap-4"><button onClick={handleAddToCart} className="flex-1 border border-white/20 text-white py-4 font-bold tracking-[0.2em] text-xs uppercase hover:bg-white hover:text-black transition-all">Add to Bag</button><button onClick={handleBuyNow} className="flex-1 bg-white text-black py-4 font-bold tracking-[0.2em] text-xs uppercase hover:bg-gray-200 transition-colors shadow-[0_0_20px_rgba(255,255,255,0.2)]">Buy Now</button></div>
                        </div>
                    </div>
                </div>
            );
        };

        const CartDrawer = ({ isOpen, close, cart, removeFromCart, goToCheckout }) => {
            const total = cart.reduce((sum, item) => sum + item.price, 0);
            return (
                <div className={`fixed inset-0 z-[60] flex justify-end transition-opacity duration-300 ${isOpen ? 'opacity-100 pointer-events-auto' : 'opacity-0 pointer-events-none'}`}>
                    <div className="absolute inset-0 bg-black/60 backdrop-blur-sm" onClick={close} />
                    <div className={`relative w-full max-w-md bg-[#0F0F0F] h-full shadow-2xl transform transition-transform duration-500 flex flex-col border-l border-white/5 ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}>
                        <div className="p-8 flex justify-between items-center border-b border-white/5"><h2 className="font-syne text-xl font-bold text-white tracking-widest uppercase">Shopping Bag <span className="text-red-600 text-sm align-top">{cart.length}</span></h2><button onClick={close} className="text-gray-400 hover:text-white transition-colors active:scale-90"><X /></button></div>
                        <div className="flex-1 overflow-y-auto p-8 space-y-8">
                            {cart.length === 0 ? <div className="text-center text-gray-500 mt-20"><ShoppingBag className="w-12 h-12 mx-auto mb-6 opacity-20" /><p className="uppercase tracking-widest text-xs">Your bag is empty</p></div> : 
                                cart.map((item, idx) => (
                                    <div key={`${item.id}-${idx}`} className="flex space-x-6">
                                        <div className="w-20 h-28 bg-zinc-900 overflow-hidden"><img src={item.image} alt={item.name} className="w-full h-full object-cover" /></div>
                                        <div className="flex-1 flex flex-col justify-between py-1"><div><div className="flex justify-between items-start"><h3 className="text-white font-syne font-bold text-sm uppercase">{item.name}</h3><button onClick={() => removeFromCart(idx)} className="text-gray-600 hover:text-white transition-colors active:scale-90"><X size={14} /></button></div><p className="text-gray-500 text-xs mt-1 uppercase tracking-wider">Size: <span className="text-white">{item.selectedSize}</span></p></div><p className="text-white font-mono text-sm">{SITE_CONFIG.currency}{item.price.toFixed(2)}</p></div>
                                    </div>
                                ))
                            }
                        </div>
                        <div className="p-8 border-t border-white/5 bg-[#0A0A0A]"><div className="flex justify-between text-white text-lg font-syne font-bold mb-6"><span>TOTAL</span><span>{SITE_CONFIG.currency}{total.toFixed(2)}</span></div><button onClick={goToCheckout} className="w-full bg-white text-black py-5 font-bold tracking-[0.2em] text-xs uppercase hover:bg-gray-200 transition-colors active:scale-95">Proceed to Checkout</button></div>
                    </div>
                </div>
            );
        };

        const CheckoutPage = ({ cart, setView }) => {
            const [step, setStep] = useState(1);
            const [paymentMethod, setPaymentMethod] = useState('credit');
            const [isProcessing, setIsProcessing] = useState(false);
            const [formData, setFormData] = useState({ firstName: "", lastName: "", email: "", address: "", city: "", postalCode: "", country: "" });
            const total = cart.reduce((sum, item) => sum + item.price, 0);
            const handleInputChange = (e) => { setFormData({...formData, [e.target.name]: e.target.value}); }
            const handleShippingSubmit = async (e) => { e.preventDefault(); if (SITE_CONFIG.formEndpoint) { try { await fetch(SITE_CONFIG.formEndpoint, { method: 'POST', body: JSON.stringify(formData), headers: { 'Content-Type': 'application/json', 'Accept': 'application/json' } }); } catch (err) { console.error("Form error", err); } } setStep(2); };
            const handlePayment = (success = true) => { setIsProcessing(true); setTimeout(() => { setIsProcessing(false); if (success) { setView('success'); } else { setView('failed'); } window.scrollTo(0, 0); }, 2000); };

            if (isProcessing) return <div className="min-h-screen bg-black flex flex-col items-center justify-center"><div className="w-16 h-16 border-2 border-t-red-600 border-white/20 rounded-full animate-spin mb-6"></div><p className="text-white font-mono text-xs tracking-[0.3em] animate-pulse">PROCESSING SECURE TRANSMISSION...</p></div>;

            return (
                <div className="pt-32 md:pt-40 min-h-screen bg-[#050505] relative z-20 pb-20">
                    <div className="container mx-auto px-6 max-w-6xl">
                        <button onClick={() => setView('home')} className="flex items-center text-gray-500 hover:text-white mb-12 text-[10px] tracking-[0.2em] transition-colors uppercase font-bold group"><ArrowRight className="w-4 h-4 mr-2 rotate-180 group-hover:-translate-x-1 transition-transform" /> Back to Collection</button>
                        <div className="grid grid-cols-1 lg:grid-cols-2 gap-12 md:gap-24">
                            <div>
                                <div className="flex items-baseline justify-between mb-12 border-b border-white/10 pb-4"><h1 className="font-syne text-2xl md:text-4xl font-bold text-white uppercase">Secure Checkout</h1><div className="text-[8px] md:text-[10px] font-mono text-red-500 tracking-widest">/// ENCRYPTED</div></div>
                                <div className="flex space-x-8 mb-12"><div className={`pb-2 border-b-2 transition-colors ${step === 1 ? 'border-red-600 text-white' : 'border-transparent text-gray-600'} cursor-pointer font-bold tracking-[0.2em] text-[10px] uppercase`} onClick={() => setStep(1)}>01. Shipping</div><div className={`pb-2 border-b-2 transition-colors ${step === 2 ? 'border-red-600 text-white' : 'border-transparent text-gray-600'} cursor-pointer font-bold tracking-[0.2em] text-[10px] uppercase`} onClick={() => step > 1 && setStep(2)}>02. Payment</div></div>
                                {step === 1 ? (
                                    <form onSubmit={handleShippingSubmit} className="animate-fade-in-up">
                                        <div className="grid grid-cols-2 gap-4 md:gap-8"><InputField label="First Name" name="firstName" value={formData.firstName} onChange={handleInputChange} placeholder="KAI" required /><InputField label="Last Name" name="lastName" value={formData.lastName} onChange={handleInputChange} placeholder="ZEN" required /></div>
                                        <InputField label="Email Address" name="email" value={formData.email} onChange={handleInputChange} type="email" placeholder="CLIENT@EXAMPLE.COM" required /><InputField label="Address Line 1" name="address" value={formData.address} onChange={handleInputChange} placeholder="123 FUTURE BLVD" required />
                                        <div className="grid grid-cols-2 gap-4 md:gap-8"><InputField label="City" name="city" value={formData.city} onChange={handleInputChange} placeholder="TOKYO" required /><InputField label="Postal Code" name="postalCode" value={formData.postalCode} onChange={handleInputChange} placeholder="100-0001" required /></div>
                                        <InputField label="Country" name="country" value={formData.country} onChange={handleInputChange} placeholder="JAPAN" required />
                                        <div className="flex gap-4 mt-12"><button type="button" onClick={() => setView('cart')} className="w-1/3 border border-white/20 text-white py-4 font-bold tracking-[0.2em] text-xs uppercase hover:bg-white/10 hover:border-white transition-all rounded-sm">Back to Bag</button><button type="submit" className="flex-1 bg-white text-black py-4 font-bold tracking-[0.2em] text-xs uppercase hover:bg-gray-200 transition-colors rounded-sm shadow-[0_0_20px_rgba(255,255,255,0.2)]">Proceed to Payment</button></div>
                                    </form>
                                ) : (
                                    <div className="animate-fade-in-up">
                                        <div className="bg-white/5 p-6 border border-white/10 mb-8 backdrop-blur-sm rounded-sm">
                                            <p className="text-[10px] text-gray-400 mb-6 tracking-[0.2em] uppercase">Select Method</p>
                                            <div className="space-y-4">
                                                {['credit', 'debit', 'apple_pay', 'paypal', 'cod'].map(m => (
                                                    <div key={m} className={`flex items-center space-x-4 p-4 border cursor-pointer transition-all rounded-sm ${paymentMethod === m ? 'border-red-600 bg-white/10' : 'border-white/10 hover:border-white/30'}`} onClick={() => setPaymentMethod(m)}>
                                                        {m === 'paypal' ? <span className="text-lg font-bold italic text-white">Pay<span className="text-blue-400">Pal</span></span> 
                                                        : m === 'apple_pay' ? <div className="flex items-center gap-2"><AppleLogo className="w-5 h-5 text-white" /><span className="text-sm font-bold tracking-widest text-white uppercase">Apple Pay</span></div>
                                                        : m === 'cod' ? <><Banknote className="w-5 h-5 text-white" /><span className="text-sm font-bold tracking-widest text-white">CASH ON DELIVERY</span></> 
                                                        : <><CreditCard className="w-5 h-5 text-white" /><span className="text-sm font-bold tracking-widest text-white uppercase">{m} CARD</span></>}
                                                    </div>
                                                ))}
                                            </div>
                                        </div>
                                        {paymentMethod !== 'cod' && paymentMethod !== 'paypal' && paymentMethod !== 'apple_pay' && (
                                            <div className="animate-fade-in-up"><InputField label="Card Number" placeholder="0000 0000 0000 0000" /><div className="grid grid-cols-2 gap-8"><InputField label="Expiry Date" placeholder="MM/YY" /><InputField label="CVC" placeholder="123" /></div></div>
                                        )}
                                        <div className="flex flex-col gap-4 mt-12">
                                            <button type="button" onClick={() => handlePayment(true)} className="w-full bg-red-600 text-white py-5 font-bold tracking-[0.2em] text-xs uppercase hover:bg-red-700 transition-colors flex items-center justify-center shadow-[0_0_20px_rgba(220,38,38,0.4)] rounded-sm active:scale-95">
                                                {paymentMethod === 'paypal' ? 'Continue with PayPal' 
                                                : paymentMethod === 'apple_pay' ? 'Pay with Apple Pay'
                                                : paymentMethod === 'cod' ? 'Place Order' 
                                                : `Pay ${SITE_CONFIG.currency}${total.toFixed(2)}`}
                                            </button>
                                            <button type="button" onClick={() => handlePayment(false)} className="w-full text-gray-600 text-[10px] font-mono hover:text-red-500 transition-colors text-center">[SIMULATE DECLINE]</button>
                                        </div>
                                    </div>
                                )}
                            </div>
                            <div className="bg-zinc-900/30 p-10 border border-white/5 h-fit backdrop-blur-md rounded-sm">
                                <h3 className="font-syne text-xl font-bold text-white mb-8 tracking-widest uppercase">Order Summary</h3>
                                <div className="space-y-6 mb-8 max-h-[400px] overflow-y-auto pr-2 custom-scrollbar">
                                    {cart.map((item, idx) => (
                                        <div key={idx} className="flex space-x-6 items-start border-b border-white/5 pb-6 last:border-0">
                                            <div className="w-16 h-20 bg-zinc-800 overflow-hidden flex-shrink-0 rounded-sm"><img src={item.image} className="w-full h-full object-cover opacity-90" onError={(e) => { e.target.src = 'https://placehold.co/100x100/111/444?text=IMG'; }} /></div>
                                            <div className="flex-1"><p className="text-white font-bold text-sm uppercase tracking-wider">{item.name}</p><p className="text-gray-500 text-[10px] mt-1 uppercase tracking-widest">Size: {item.selectedSize}</p><p className="text-red-500 text-xs mt-2 font-mono">{SITE_CONFIG.currency}{item.price.toFixed(2)}</p></div>
                                        </div>
                                    ))}
                                </div>
                                <div className="border-t border-white/10 pt-6 space-y-3"><div className="flex justify-between text-gray-400 text-xs uppercase tracking-widest"><span>Subtotal</span><span>{SITE_CONFIG.currency}{total.toFixed(2)}</span></div><div className="flex justify-between text-gray-400 text-xs uppercase tracking-widest"><span>Shipping</span><span className="text-white">Complimentary</span></div></div>
                                <div className="border-t border-white/10 pt-6 mt-6 flex justify-between text-white font-syne font-bold text-xl"><span>Total</span><span>{SITE_CONFIG.currency}{total.toFixed(2)}</span></div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        const PaymentSuccess = ({ setView }) => (
            <div className="pt-32 md:pt-48 pb-20 min-h-screen flex flex-col items-center justify-center relative overflow-hidden">
                <div className="absolute inset-0 bg-[radial-gradient(circle_at_center,_var(--tw-gradient-stops))] from-green-900/20 via-black to-black z-0"></div>
                <div className="z-10 text-center p-8 md:p-12 border border-white/10 bg-white/5 backdrop-blur-xl max-w-lg w-full mx-4 shadow-2xl animate-fade-in-up">
                    <div className="w-20 h-20 mx-auto mb-8 rounded-full border-2 border-green-500 flex items-center justify-center shadow-[0_0_20px_rgba(34,197,94,0.4)]"><Check className="w-10 h-10 text-green-500" /></div>
                    <h1 className="font-syne text-3xl md:text-5xl text-white uppercase tracking-tighter mb-4">Order Confirmed</h1><p className="text-green-500 font-mono text-xs tracking-[0.2em] mb-8">/// TRANSACTION_VERIFIED</p><p className="text-gray-400 text-sm leading-relaxed mb-10 font-light">Your gear has been secured. A confirmation transmission has been sent to your secure comms channel.</p>
                    <button onClick={() => setView('home')} className="w-full bg-white text-black py-4 font-bold tracking-[0.2em] text-xs uppercase hover:bg-gray-200 transition-colors active:scale-95">Return to Base</button>
                </div>
            </div>
        );

        const PaymentFailed = ({ setView }) => (
            <div className="pt-32 md:pt-48 pb-20 min-h-screen flex flex-col items-center justify-center relative overflow-hidden">
                <div className="absolute inset-0 bg-[radial-gradient(circle_at_center,_var(--tw-gradient-stops))] from-red-900/20 via-black to-black z-0"></div>
                <div className="z-10 text-center p-8 md:p-12 border border-red-900/50 bg-black/80 backdrop-blur-xl max-w-lg w-full mx-4 shadow-2xl animate-shake">
                    <div className="w-20 h-20 mx-auto mb-8 rounded-full border-2 border-red-600 flex items-center justify-center shadow-[0_0_20px_rgba(220,38,38,0.4)]"><AlertOctagon className="w-10 h-10 text-red-600" /></div>
                    <h1 className="font-syne text-3xl md:text-5xl text-white uppercase tracking-tighter mb-4">Transaction Declined</h1><p className="text-red-600 font-mono text-xs tracking-[0.2em] mb-8">/// ERROR_CODE_X71</p><p className="text-gray-400 text-sm leading-relaxed mb-10 font-light">Payment gateway rejected the connection. Please verify your credentials and retry the transmission.</p>
                    <div className="flex gap-4"><button onClick={() => setView('checkout')} className="flex-1 bg-red-600 text-white py-4 font-bold tracking-[0.2em] text-xs uppercase hover:bg-red-700 transition-colors active:scale-95">Retry</button><button onClick={() => setView('home')} className="flex-1 border border-white/20 text-white py-4 font-bold tracking-[0.2em] text-xs uppercase hover:bg-white/10 transition-colors active:scale-95">Cancel</button></div>
                </div>
            </div>
        );

        const DriftyChat = () => {
            const [messages, setMessages] = useState([{ id: 1, sender: 'bot', text: "Hi there! I'm Drifty, your personal style AI. How can I help you today? ✨" }]);
            const [inputValue, setInputValue] = useState("");
            const chatEndRef = useRef(null);
            useEffect(() => { chatEndRef.current?.scrollIntoView({ behavior: "smooth" }); }, [messages]);
            const handleSend = (e) => {
                e.preventDefault(); if (!inputValue.trim()) return;
                const userText = inputValue; setMessages(prev => [...prev, { id: Date.now(), sender: 'user', text: userText }]); setInputValue("");
                setTimeout(() => {
                    let botResponse = "I'm still learning, but I'll do my best! For complex issues, I can connect you to a human.";
                    const lowerText = userText.toLowerCase();
                    if (lowerText.includes("ship")) botResponse = "We ship globally! 🌍 Most orders fly out within 24 hours.";
                    else if (lowerText.includes("return")) botResponse = "No worries! You have 30 days to return anything.";
                    else if (lowerText.includes("size")) botResponse = "We specialize in oversized fits. Size down for standard fit.";
                    setMessages(prev => [...prev, { id: Date.now() + 1, sender: 'bot', text: botResponse }]);
                }, 1000);
            };
            return (
                <div className="relative bg-black border border-white/10 h-[600px] flex flex-col shadow-2xl overflow-hidden rounded-sm">
                    <div className="bg-zinc-900/80 backdrop-blur-md p-4 border-b border-white/10 flex justify-between items-center">
                        <div className="flex items-center gap-3"><div className="w-12 h-12 rounded-full bg-zinc-800 border border-red-500/30 flex items-center justify-center relative"><div className="w-3 h-3 bg-green-500 rounded-full absolute bottom-0 right-0"></div></div><div><span className="font-syne font-bold text-white text-sm block uppercase tracking-wider">Drifty</span><span className="font-mono text-[9px] text-red-500 tracking-widest uppercase animate-pulse">/// AI_STYLIST_ONLINE</span></div></div>
                    </div>
                    <div className="flex-1 overflow-y-auto p-6 space-y-6 custom-scrollbar bg-[url('https://www.transparenttextures.com/patterns/carbon-fibre.png')]">{messages.map((msg) => (<div key={msg.id} className={`flex ${msg.sender === 'user' ? 'justify-end' : 'justify-start'}`}><div className={`max-w-[85%] p-4 text-xs font-sans leading-relaxed rounded-2xl ${msg.sender === 'user' ? 'bg-white text-black rounded-tr-none' : 'bg-zinc-900/90 text-gray-200 border border-white/10 rounded-tl-none'}`}>{msg.text}</div></div>))}<div ref={chatEndRef} /></div>
                    <form onSubmit={handleSend} className="p-4 border-t border-white/10 bg-black flex gap-3"><input type="text" value={inputValue} onChange={(e) => setInputValue(e.target.value)} placeholder="Ask Drifty..." className="flex-1 bg-white/5 border border-white/10 rounded-full px-6 py-3 text-white text-xs font-sans focus:border-red-500 outline-none" /><button type="submit" className="bg-white text-black px-6 py-2 rounded-full font-bold text-[10px] uppercase tracking-widest hover:bg-red-600 hover:text-white transition-colors">Send</button></form>
                </div>
            );
        };

        const SuggestionBox = () => {
            const [text, setText] = useState(""); const [sent, setSent] = useState(false);
            const handleSuggest = (e) => { e.preventDefault(); setSent(true); setTimeout(() => { setSent(false); setText(""); }, 3000); };
            return (
                <div className="bg-zinc-900/30 border border-white/10 p-8 backdrop-blur-md mt-8 relative overflow-hidden group">
                    <div className="absolute top-0 right-0 w-20 h-20 bg-gradient-to-bl from-red-900/20 to-transparent rounded-bl-full pointer-events-none"></div>
                    <h3 className="text-white font-syne text-xl uppercase mb-2">Suggestion Box</h3><p className="text-gray-500 text-xs mb-6 font-light">Help us improve. Submit your ideas anonymously.</p>
                    {sent ? <div className="h-32 flex flex-col items-center justify-center animate-fade-in-up border border-green-500/30 bg-green-500/10"><Check className="w-8 h-8 text-green-500 mb-2" /><p className="text-white text-xs tracking-widest uppercase">Feedback Received</p></div> : <form onSubmit={handleSuggest} className="space-y-4"><textarea value={text} onChange={(e) => setText(e.target.value)} placeholder="Type your suggestion here..." rows="3" className="w-full bg-black/50 border border-white/10 p-4 text-white text-xs outline-none focus:border-red-600 transition-colors resize-none placeholder-zinc-700 font-mono" required></textarea><button className="w-full border border-white/20 text-white py-3 text-[10px] font-bold tracking-[0.2em] uppercase hover:bg-white hover:text-black transition-all active:scale-95">Submit Suggestion</button></form>}
                </div>
            );
        };

        const CustomerCarePage = () => (
            <div className="pt-32 md:pt-48 pb-20 min-h-screen container mx-auto px-6 max-w-4xl">
               <h1 className="font-syne text-4xl font-bold mb-12 text-white uppercase">Support Center</h1>
               <div className="grid md:grid-cols-2 gap-12">
                   <div>
                       <h3 className="font-bold text-white mb-4 uppercase text-sm tracking-wider">FAQ</h3>
                       <div className="space-y-6 text-gray-400 text-xs leading-relaxed">
                           <p><strong className="text-white block mb-1">Shipping?</strong>Global. 3-5 business days.</p>
                           <p><strong className="text-white block mb-1">Returns?</strong>30 days. No questions asked.</p>
                       </div>
                   </div>
                   <div>
                        <h3 className="font-bold text-white mb-4 uppercase text-sm tracking-wider">Contact</h3>
                        <p className="text-gray-400 text-xs mb-4">For immediate assistance, use our AI chat.</p>
                        <DriftyChat />
                        <SuggestionBox />
                   </div>
               </div>
            </div>
        );

        // --- SECTIONS ---
        const Hero = ({ setView }) => (
            <div className="relative h-screen w-full overflow-hidden">
                <div className="absolute inset-0 z-0">
                    <img src="https://images.unsplash.com/photo-1543087903-1ac2ec7aa8c5?q=80&w=2098&auto=format&fit=crop" alt="Hero" className="w-full h-full object-cover opacity-60 filter contrast-125 saturate-50" />
                    <div className="absolute inset-0 bg-gradient-to-b from-black/20 via-transparent to-black"></div>
                </div>
                <div className="relative z-10 h-full flex flex-col items-center justify-center text-center px-4 pt-24 md:pt-32">
                    <div className="border border-white/20 px-4 py-1 mb-6 animate-fade-in-up backdrop-blur-sm bg-white/5 rounded-full">
                        <p className="text-red-400 font-syne text-[10px] font-bold tracking-[0.4em] uppercase">Holiday Campaign '25</p>
                    </div>
                    <h1 className="font-syne font-800 text-5xl md:text-9xl text-white uppercase tracking-tighter mb-4 leading-[0.9] md:leading-[0.8] mix-blend-overlay opacity-90 animate-fade-in-up delay-100 drop-shadow-2xl">Winter<br/>Solstice</h1>
                    <div className="flex flex-col items-center gap-6 mt-8 animate-fade-in-up delay-300">
                        <button onClick={() => setView('new_drops')} className="group relative px-12 py-4 bg-white/10 backdrop-blur-md border border-white/20 overflow-hidden hover:bg-white/20 transition-all rounded-sm active:scale-95">
                            <span className="relative text-white text-xs font-bold tracking-[0.3em] uppercase pb-1 transition-all">Shop The Drops</span>
                        </button>
                    </div>
                </div>
            </div>
        );

        const Navbar = ({ cartCount, setView, currentView, toggleCart }) => {
            const [isScrolled, setIsScrolled] = useState(false);
            const [mobileMenuOpen, setMobileMenuOpen] = useState(false);
            const [imgError, setImgError] = useState(false); 
            useEffect(() => {
                const handleScroll = () => setIsScrolled(window.scrollY > 50);
                window.addEventListener('scroll', handleScroll);
                return () => window.removeEventListener('scroll', handleScroll);
            }, []);
            
            const navLinks = [ 
                { name: 'HOME', view: 'home' }, 
                { name: 'ACCESSORIES', view: 'accessories' }, 
                { name: 'THE VISION', view: 'vision' }, 
                { name: 'SUPPORT', view: 'support' }
            ];

            return (
                <nav className={`w-full transition-all duration-700 z-[60] flex flex-col justify-center border-b border-white/5 ${isScrolled ? 'bg-black/40 backdrop-blur-2xl py-2 shadow-2xl' : 'bg-white/5 backdrop-blur-lg py-4 md:py-6'}`}>
                    <div className="container mx-auto px-6 md:px-12 relative">
                        <div className="absolute left-0 md:left-6 top-1/2 transform -translate-y-1/2 flex items-center z-20">
                            <button className="md:hidden text-white mr-6 p-2 active:scale-90 transition-transform" onClick={() => setMobileMenuOpen(!mobileMenuOpen)} aria-label="Toggle Menu">{mobileMenuOpen ? <X /> : <Menu />}</button>
                            <Search className="w-5 h-5 text-white cursor-pointer hover:text-red-500 transition-colors hidden md:block opacity-80 hover:opacity-100" />
                        </div>
                        <div onClick={() => setView('home')} className="flex flex-col items-center justify-center cursor-pointer group w-full touch-manipulation">
                            <img src={SITE_CONFIG.logoUrl} alt="Logo" onError={(e) => { e.target.style.display = 'none'; }} className={`object-contain transition-all duration-700 ease-in-out drop-shadow-[0_0_15px_rgba(255,255,255,0.2)] ${isScrolled ? 'h-10 md:h-14 opacity-100' : 'h-10 md:h-24 mb-1 md:mb-2 opacity-100'}`} />
                            {!imgError ? (<img src={SITE_CONFIG.brandFontImage} alt={SITE_CONFIG.brandName} onError={() => setImgError(true)} className={`transition-all duration-500 ease-in-out object-contain ${isScrolled ? 'h-0 opacity-0' : 'h-6 md:h-8 mt-2 opacity-100'}`} />) : (<span className={`text-white font-luxury tracking-[0.3em] uppercase transition-all duration-500 overflow-hidden text-shadow-sm ${isScrolled ? 'h-0 opacity-0 text-[0px]' : 'h-auto opacity-100 mt-1 md:mt-2 text-xs md:text-3xl'}`}>{SITE_CONFIG.brandName}</span>)}
                        </div>
                        <div className="absolute right-0 md:right-6 top-1/2 transform -translate-y-1/2 flex items-center z-20">
                            <div className="relative cursor-pointer hover:text-red-500 transition-colors text-white opacity-80 hover:opacity-100 p-2 active:scale-95 transition-transform" onClick={toggleCart}>
                                <ShoppingBag className="w-5 h-5" />
                                {cartCount > 0 && <span className="absolute -top-1 -right-1 bg-red-600 text-white text-[9px] font-bold w-4 h-4 flex items-center justify-center rounded-full shadow-md">{cartCount}</span>}
                            </div>
                        </div>
                    </div>
                    <div className={`hidden md:flex justify-center space-x-12 md:space-x-16 transition-all duration-700 border-t border-white/0 ${isScrolled ? 'mt-2 pt-0 border-white/0 h-0 opacity-0 pointer-events-none' : 'mt-4 md:mt-6 pt-4 border-white/10 h-auto opacity-100'}`}>
                        {navLinks.map((link) => (<button key={link.name} onClick={() => setView(link.view)} className={`relative text-[11px] font-syne font-bold tracking-[0.25em] transition-all uppercase group hover:text-white text-shadow-sm ${currentView === link.view ? 'text-white' : 'text-gray-300'}`}>{link.name}<span className={`absolute -bottom-2 left-1/2 transform -translate-x-1/2 w-0 h-[1px] bg-white transition-all duration-500 ease-out group-hover:w-full ${currentView === link.view ? 'w-full' : ''}`}></span></button>))}
                    </div>
                    {mobileMenuOpen && (
                        <div className="absolute top-full left-0 w-full h-screen bg-black/80 backdrop-blur-2xl border-t border-white/10 p-10 flex flex-col items-center space-y-8 md:hidden animate-fade-in-down touch-pan-y">
                            {navLinks.map((link) => (<button key={link.name} onClick={() => { setView(link.view); setMobileMenuOpen(false); }} className={`text-center text-2xl font-luxury tracking-[0.2em] uppercase hover:text-red-500 transition-colors text-white active:scale-95`}>{link.name}</button>))}
                        </div>
                    )}
                </nav>
            );
        };

        const CuratedRail = ({ setView }) => {
            const items = [
                { label: "FOR YOU", icon: <Heart className="w-6 h-6 text-white" />, view: 'home', specialClass: "border-red-600" },
                { label: "WINTER", icon: <Snowflake className="w-6 h-6 text-white" />, view: 'men' },
                { label: "DROPS", icon: <Zap className="w-6 h-6 text-yellow-400" />, view: 'new_drops' },
                { label: "EXPRESS", icon: <Truck className="w-6 h-6 text-blue-400" />, view: 'support' },
                { label: "ARCHIVE", icon: <Database className="w-6 h-6 text-purple-400" />, view: 'home' },
                { label: "VIP", icon: <Crown className="w-6 h-6 text-white" />, view: 'home' },
                { label: "SHOES", icon: <Shoe className="w-6 h-6 text-gray-300" />, view: 'accessories' },
            ];
            return (
                <div className="py-8 border-b border-white/5 bg-[#050505]">
                     <div className="container mx-auto px-4">
                        <div className="flex items-center justify-between mb-6">
                            <h3 className="font-syne text-lg font-bold text-white uppercase tracking-wider">Shop By Category</h3>
                            <span className="text-[10px] text-gray-500 font-mono hidden md:block">/// QUICK_ACCESS</span>
                        </div>
                        <div className="flex overflow-x-auto gap-6 pb-4 no-scrollbar snap-x">
                            {items.map((item, idx) => (
                                <div key={idx} className="flex flex-col items-center gap-3 snap-center cursor-pointer group min-w-[80px]" onClick={() => setView(item.view)}>
                                    <div className={`w-20 h-20 md:w-24 md:h-24 rounded-full border-2 flex items-center justify-center relative overflow-hidden transition-all duration-300 ${item.specialClass ? 'border-red-600' : 'border-white/10 group-hover:border-white'}`}>
                                        <div className="absolute inset-0 bg-zinc-900 group-hover:scale-110 transition-transform duration-500"></div>
                                        <div className="relative z-10 transform group-hover:scale-110 transition-transform duration-300">{item.icon}</div>
                                    </div>
                                    <span className="text-[10px] md:text-xs font-bold text-gray-400 uppercase tracking-widest group-hover:text-white text-center leading-tight transition-colors">{item.label}</span>
                                </div>
                            ))}
                        </div>
                     </div>
                </div>
            );
        };

        const TheFashionFrontier = ({ setView }) => {
            const [hovered, setHovered] = useState(null);
            const SECTORS = [
                { id: 'men', title: 'MEN', subtitle: 'ARCHITECTURAL FITS', img: 'https://images.unsplash.com/photo-1617137984095-74e4e5e3613f?q=80&w=1200&auto=format&fit=crop' },
                { id: 'women', title: 'WOMEN', subtitle: 'FUTURE SILHOUETTE', img: 'https://images.unsplash.com/photo-1539109136881-3be0616acf4b?q=80&w=1200&auto=format&fit=crop' },
                { id: 'kids', title: 'KIDS', subtitle: 'NEXT GEN', img: 'https://images.unsplash.com/photo-1503919545889-aef636e10ad4?q=80&w=1200&auto=format&fit=crop' }
            ];
            return (
                <section className="relative w-full h-[85vh] bg-[#050505] overflow-hidden border-t border-white/5">
                    <div className="absolute top-10 left-0 w-full z-20 pointer-events-none px-8 flex justify-between items-start mix-blend-difference text-white">
                        <div><span className="font-mono text-[10px] tracking-[0.4em] uppercase block mb-2">/ Sector Select</span><h2 className="font-syne text-3xl font-bold uppercase tracking-tight">The Frontier</h2></div>
                        <div className="hidden md:block text-right"><span className="font-mono text-[10px] tracking-widest uppercase block">Select Protocol</span><div className="flex gap-2 mt-2"><div className="w-1 h-1 bg-white rounded-full animate-pulse"></div><div className="w-1 h-1 bg-white rounded-full animate-pulse delay-75"></div><div className="w-1 h-1 bg-white rounded-full animate-pulse delay-150"></div></div></div>
                    </div>
                    <div className="w-full h-full flex transform -skew-x-12 scale-110 origin-center translate-x-[-2%] md:translate-x-0">
                        {SECTORS.map((sector, idx) => (
                            <div key={sector.id} onMouseEnter={() => setHovered(sector.id)} onMouseLeave={() => setHovered(null)} onClick={() => setView(sector.id)} className={`relative h-full transition-all duration-700 ease-[cubic-bezier(0.22,1,0.36,1)] cursor-pointer border-r border-white/10 overflow-hidden group ${hovered === sector.id ? 'flex-[3]' : hovered ? 'flex-[0.8]' : 'flex-1'}`}>
                                <div className="absolute inset-[-20%] w-[140%] h-[140%] transform skew-x-12 origin-center"><div className="relative w-full h-full"><img src={sector.img} alt={sector.title} className={`w-full h-full object-cover transition-all duration-1000 ${hovered === sector.id ? 'scale-100 grayscale-0' : 'scale-110 grayscale opacity-60 group-hover:opacity-100'}`} /><div className={`absolute inset-0 bg-black/40 transition-opacity duration-500 ${hovered === sector.id ? 'opacity-20' : 'opacity-60'}`}></div>{hovered === sector.id && <div className="absolute inset-0 bg-[linear-gradient(transparent_50%,rgba(0,0,0,0.5)_50%)] bg-[size:100%_4px] opacity-10 pointer-events-none animate-scan"></div>}</div></div>
                                <div className="absolute bottom-20 left-10 z-10 transform skew-x-12 pointer-events-none"><div className="overflow-hidden"><span className={`block font-mono text-[10px] text-red-500 tracking-[0.4em] mb-2 transition-transform duration-500 ${hovered === sector.id ? 'translate-y-0 opacity-100' : 'translate-y-full opacity-0'}`}>/// {sector.id.toUpperCase()}_COLLECTION</span></div><h3 className={`font-syne font-black text-6xl md:text-8xl text-white uppercase tracking-tighter leading-[0.8] transition-all duration-500 ${hovered === sector.id ? 'text-white translate-x-4' : 'text-transparent text-stroke translate-x-0'}`}>{sector.title}</h3><div className={`h-[1px] bg-white mt-6 transition-all duration-500 ease-out ${hovered === sector.id ? 'w-24 opacity-100' : 'w-0 opacity-0'}`}></div><p className={`mt-4 text-xs font-mono text-gray-300 tracking-widest uppercase transition-all duration-500 delay-100 ${hovered === sector.id ? 'opacity-100 translate-y-0' : 'opacity-0 translate-y-4'}`}>{sector.subtitle}</p></div>
                                <div className="absolute top-10 right-10 z-0 transform skew-x-12 opacity-10 pointer-events-none"><span className="font-syne font-bold text-9xl text-white">0{idx + 1}</span></div>
                            </div>
                        ))}
                    </div>
                </section>
            );
        };

        const MaterialInnovation = () => {
            const [selectedTech, setSelectedTech] = useState(null);
            const TECH_DATA = [
                { id: "001", name: "Ballistic Weave", shortDesc: "Military-grade abrasion resistance.", longDesc: "Utilizes high-tenacity nylon filaments woven in a dense 2x2 basket structure.", image: "https://i.postimg.cc/CK37HhVd/Gemini-Generated-Image-oxoxujoxoxujoxox.png", specs: ["1050D Nylon", "Tear Strength: >800N"] },
                { id: "002", name: "Gore-Tex Pro", shortDesc: "3-layer breathable waterproof protection.", longDesc: "The gold standard in weather protection. 3-layer membrane system.", image: "https://i.postimg.cc/m2pQyLYs/Gemini-Generated-Image-fsvzojfsvzojfsvz.png", specs: ["Waterproof: 28,000mm", "Breathability: RET < 6"] },
                { id: "003", name: "Carbon Fiber Mesh", shortDesc: "Ultra-lightweight structural integrity.", longDesc: "Derived from aerospace engineering, this lightweight mesh provides support.", image: "https://i.postimg.cc/ZRPQWByz/Gemini-Generated-Image-1cs2ai1cs2ai1cs2.png", specs: ["High Modulus Carbon", "Weight: 150g/m²"] }
            ];
            return (
                <>
                    <section className="py-16 md:py-32 bg-[#0A0A0A] border-y border-white/5">
                        <div className="container mx-auto px-6 max-w-5xl">
                            <div className="text-center mb-16 md:mb-24">
                                <span className="text-red-600 font-mono text-[10px] tracking-[0.3em] uppercase block mb-6">Innovation Lab</span>
                                <h2 className="font-syne text-4xl md:text-7xl text-white uppercase font-bold tracking-tighter">Materiology</h2>
                            </div>
                            <div className="space-y-12">
                                {TECH_DATA.map((tech, idx) => (
                                    <div key={idx} className="group border-b border-white/10 pb-8 md:pb-12 hover:border-white transition-colors cursor-pointer relative touch-manipulation" onClick={() => setSelectedTech(tech)}>
                                        <div className="flex flex-col md:flex-row md:items-baseline justify-between">
                                            <div className="flex items-baseline gap-4 md:gap-8"><span className="text-xs font-mono text-gray-600 group-hover:text-red-500 transition-colors">/ {tech.id}</span><h3 className="text-2xl md:text-5xl font-syne font-bold text-gray-400 group-hover:text-white transition-colors uppercase">{tech.name}</h3></div>
                                            <p className="mt-4 md:mt-0 max-w-md text-sm text-gray-500 group-hover:text-gray-300 font-mono transition-colors">{tech.shortDesc}</p>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </div>
                    </section>
                    <div className={`fixed inset-0 z-[100] flex justify-end transition-opacity duration-500 ${selectedTech ? 'opacity-100 pointer-events-auto' : 'opacity-0 pointer-events-none'}`}>
                        <div className="absolute inset-0 bg-black/60 backdrop-blur-sm" onClick={() => setSelectedTech(null)}></div>
                        <div className={`relative w-full max-w-xl bg-[#0A0A0A] h-full shadow-2xl transform transition-transform duration-500 border-l border-white/10 flex flex-col ${selectedTech ? 'translate-x-0' : 'translate-x-full'}`}>
                            <div className="p-8 flex justify-between items-center border-b border-white/10 bg-black/50 backdrop-blur-md absolute top-0 left-0 w-full z-20">
                                <span className="font-mono text-[10px] text-white tracking-[0.3em] uppercase">INNOVATION_LAB // {selectedTech?.id}</span>
                                <button onClick={() => setSelectedTech(null)} className="text-white"><X size={20}/></button>
                            </div>
                            <div className="flex-1 overflow-y-auto pt-24 pb-12 no-scrollbar p-8">
                                {selectedTech && (
                                    <div>
                                        <img src={selectedTech.image} className="w-full h-64 object-cover mb-8 opacity-80" />
                                        <h2 className="font-syne text-4xl text-white font-bold mb-4 uppercase">{selectedTech.name}</h2>
                                        <p className="text-gray-400 text-sm mb-8">{selectedTech.longDesc}</p>
                                        <div className="grid grid-cols-1 gap-2">
                                            {selectedTech.specs.map(s => <div key={s} className="text-xs font-mono text-red-500 border border-white/10 p-2">{s}</div>)}
                                        </div>
                                    </div>
                                )}
                            </div>
                        </div>
                    </div>
                </>
            );
        };

        const TheVault = ({ addToCart }) => {
            const VAULT_ITEMS = [
                { id: "V-01", name: "Midnight Silk Tee", price: 150.00, image: "https://images.unsplash.com/photo-1583743814966-8936f5b7be1a?auto=format&fit=crop&q=80&w=600", edition: "1 of 50", desc: "Hand-woven organic silk blend. The ultimate luxury basic." },
                { id: "V-02", name: "Stealth Bomber Jacket", price: 450.00, image: "https://i.postimg.cc/P5cHnRDF/IMG-2221.jpg", edition: "Prototype", desc: "Radar-absorbent material coating. Weatherproof functionality." },
                { id: "V-03", name: "Obsidian Cargo", price: 220.00, image: "https://images.unsplash.com/photo-1552160793-eb2891729c36?q=80&w=1000&auto=format&fit=crop", edition: "Limited Batch", desc: "Japanese raw denim infused with Kevlar reinforcements." }
            ];
            return (
                <section className="py-24 bg-black border-t border-white/10 relative overflow-hidden">
                    <div className="absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/carbon-fibre.png')] opacity-20"></div>
                    <div className="absolute top-0 left-1/2 -translate-x-1/2 w-full h-96 bg-red-900/20 blur-[120px] pointer-events-none rounded-full"></div>
                    <div className="container mx-auto px-6 relative z-10">
                        <div className="flex flex-col md:flex-row justify-between items-end mb-16 border-b border-white/10 pb-6">
                            <div>
                                <div className="flex items-center gap-2 mb-2"><div className="w-2 h-2 bg-red-600 animate-pulse rounded-full"></div><span className="text-red-600 font-mono text-xs tracking-[0.3em] uppercase">RESTRICTED_ACCESS</span></div>
                                <h2 className="font-syne text-4xl md:text-6xl text-white uppercase font-bold tracking-tight">The Vault</h2>
                            </div>
                            <div className="hidden md:block text-right"><p className="text-gray-500 font-mono text-[10px] tracking-widest uppercase">Encryption: AES-256</p><p className="text-gray-500 font-mono text-[10px] tracking-widest uppercase">Status: Secure</p></div>
                        </div>
                        <div className="grid grid-cols-1 md:grid-cols-3 gap-8">
                            {VAULT_ITEMS.map((item, idx) => (
                                <div key={idx} className="group relative h-[550px] bg-[#080808] border border-white/5 overflow-hidden transition-all duration-500 hover:border-red-600/40 hover:shadow-[0_0_30px_rgba(220,38,38,0.1)]">
                                    <div className="absolute inset-0 z-0"><img src={item.image} alt={item.name} className="w-full h-full object-cover opacity-50 grayscale transition-all duration-700 group-hover:grayscale-0 group-hover:opacity-90 group-hover:scale-105" /><div className="absolute inset-0 bg-gradient-to-t from-black via-black/40 to-transparent"></div></div>
                                    <div className="absolute top-0 left-0 w-full h-px bg-gradient-to-r from-transparent via-red-600/50 to-transparent translate-x-[-100%] group-hover:translate-x-[100%] transition-transform duration-1000 ease-in-out"></div>
                                    <div className="absolute bottom-0 left-0 w-full h-px bg-gradient-to-r from-transparent via-red-600/50 to-transparent translate-x-[100%] group-hover:translate-x-[-100%] transition-transform duration-1000 ease-in-out"></div>
                                    <div className="absolute inset-0 p-8 flex flex-col justify-between z-10">
                                        <div className="flex justify-between items-start translate-y-[-10px] opacity-70 group-hover:translate-y-0 group-hover:opacity-100 transition-all duration-500"><span className="font-mono text-[10px] text-red-500 border border-red-500/30 px-2 py-1 bg-black/80 backdrop-blur-md">{item.id}</span><span className="font-mono text-[10px] text-white bg-white/10 px-2 py-1 backdrop-blur-md border border-white/10">{item.edition}</span></div>
                                        <div className="translate-y-4 group-hover:translate-y-0 transition-transform duration-500">
                                            <h3 className="font-syne text-2xl md:text-3xl text-white font-bold uppercase mb-2 leading-none tracking-tight">{item.name}</h3>
                                            <div className="grid grid-rows-[0fr] group-hover:grid-rows-[1fr] transition-all duration-500 ease-in-out"><div className="overflow-hidden"><p className="text-gray-400 text-xs font-mono mb-6 pt-2 leading-relaxed opacity-0 group-hover:opacity-100 transition-opacity duration-700 delay-100 border-l border-red-600 pl-3">{item.desc}</p></div></div>
                                            <div className="flex items-center justify-between border-t border-white/10 pt-5 mt-2"><span className="text-xl font-syne font-bold text-white">{SITE_CONFIG.currency}{item.price.toFixed(2)}</span><button onClick={() => addToCart({...item, selectedSize: "L"})} className="bg-white text-black px-6 py-3 text-[10px] font-bold uppercase tracking-[0.2em] hover:bg-red-600 hover:text-white transition-all active:scale-95 flex items-center gap-2">Acquire <Lock className="w-3 h-3" /></button></div>
                                        </div>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>
                </section>
            );
        };

        const VisionPage = () => (
            <div className="pt-32 md:pt-48 pb-20 min-h-screen container mx-auto px-6 max-w-4xl text-center animate-fade-in-up">
                <span className="text-red-600 font-mono text-xs tracking-[0.3em] uppercase block mb-8">/// THE_ORIGIN</span><h1 className="font-syne text-5xl md:text-8xl font-black text-white uppercase tracking-tighter mb-12 leading-[0.85]">FORGED IN<br/>THE VOID</h1>
                <div className="text-gray-400 text-lg md:text-xl leading-relaxed font-light space-y-8 max-w-2xl mx-auto"><p>Drift N Threads was born from a collision of necessity and digital aesthetics. In a world increasingly blurred between the physical and the virtual, we engineer garments that traverse both realms.</p><p>We are not a brand. We are a movement. A glitch in the system.</p></div>
                <div className="mt-20 grid grid-cols-1 md:grid-cols-2 gap-8"><img src="https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&q=80&w=800" className="w-full h-96 object-cover grayscale hover:grayscale-0 transition-all duration-700" /><img src="https://images.unsplash.com/photo-1492633423870-43d1cd2775eb?auto=format&fit=crop&q=80&w=800" className="w-full h-96 object-cover grayscale hover:grayscale-0 transition-all duration-700" /></div>
            </div>
        );

        // --- NEW: CYBER-OPTIC LENS LOADING SCREEN ---
        const LoadingScreen = ({ onComplete }) => {
            const [progress, setProgress] = useState(0);
            const [imgIndex, setImgIndex] = useState(0);
            const FLASH_ASSETS = ["https://images.unsplash.com/photo-1529139574466-a302d2052505?q=80&w=600&auto=format&fit=crop","https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&q=80&w=600","https://images.unsplash.com/photo-1552160793-eb2891729c36?q=80&w=600&auto=format&fit=crop","https://images.unsplash.com/photo-1532453288672-3a27e9be9efd?q=80&w=600&auto=format&fit=crop"];
            useEffect(() => {
                const interval = setInterval(() => { setProgress(prev => { if (prev >= 100) { clearInterval(interval); setTimeout(onComplete, 600); return 100; } return prev + 1; }); }, 30);
                const imgInterval = setInterval(() => { setImgIndex(prev => (prev + 1) % FLASH_ASSETS.length); }, 150);
                return () => { clearInterval(interval); clearInterval(imgInterval); };
            }, [onComplete]);
            return (
                <div className="fixed inset-0 z-[300] bg-black flex flex-col items-center justify-center cursor-wait overflow-hidden">
                    <div className="absolute inset-0 opacity-20 pointer-events-none bg-[linear-gradient(rgba(255,255,255,0.03)_1px,transparent_1px),linear-gradient(90deg,rgba(255,255,255,0.03)_1px,transparent_1px)] bg-[size:40px_40px]"></div>
                    <div className="relative z-10 flex flex-col items-center">
                        <div className="relative w-48 h-48 md:w-64 md:h-64 mb-10 group">
                            <div className="absolute inset-0 rounded-full border border-white/10"></div>
                            <div className="absolute inset-[-10px] rounded-full border-t-2 border-r-2 border-red-600/80 animate-spin" style={{ animationDuration: '1.5s' }}></div>
                            <div className="absolute inset-[-4px] rounded-full border-b border-l border-white/30 animate-spin" style={{ animationDirection: 'reverse', animationDuration: '2s' }}></div>
                            <div className="absolute inset-2 rounded-full overflow-hidden bg-zinc-900 border border-white/5 flex items-center justify-center">
                                <img src={FLASH_ASSETS[imgIndex]} alt="Loading" className="absolute inset-0 w-full h-full object-cover opacity-30 mix-blend-luminosity scale-125 transition-opacity duration-75" />
                                <div className="relative z-20 w-3/4 h-3/4 flex items-center justify-center"><img src={SITE_CONFIG.logoUrl} alt="Drift Logo" className="w-full h-auto object-contain drop-shadow-[0_0_25px_rgba(255,255,255,0.4)] animate-pulse" onError={(e) => { e.target.style.display = 'none'; }} /></div>
                                <div className="absolute inset-0 flex items-center justify-center opacity-40 z-30 pointer-events-none"><div className="w-full h-[1px] bg-white/40"></div><div className="h-full w-[1px] bg-white/40 absolute"></div><div className="w-20 h-20 border border-white/40 rounded-full"></div></div>
                            </div>
                        </div>
                        <div className="text-center"><h1 className="font-syne font-black text-6xl md:text-8xl text-white tracking-tighter leading-none mb-2">{progress}%</h1><div className="flex items-center justify-center gap-3"><span className="w-1.5 h-1.5 bg-red-600 rounded-sm animate-pulse"></span><span className="font-mono text-[10px] text-gray-400 tracking-[0.4em] uppercase">Loading Assets</span><span className="w-1.5 h-1.5 bg-red-600 rounded-sm animate-pulse"></span></div></div>
                    </div>
                    <div className="absolute bottom-8 left-8 text-[8px] font-mono text-gray-600 uppercase tracking-widest hidden md:block">System: Drift_OS<br/>Status: Nominal</div><div className="absolute bottom-8 right-8 text-[8px] font-mono text-gray-600 uppercase tracking-widest hidden md:block text-right">Est. 2025<br/>Encrypted</div>
                </div>
            );
        };

        const SmoothSnow = () => { return null; };

        const CustomizerTeaser = ({ setView }) => (
            <section className="relative py-32 bg-black overflow-hidden border-t border-white/10 group">
                <div className="absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/diagmonds-light.png')] opacity-10"></div>
                <div className="absolute inset-0 bg-gradient-to-r from-black via-transparent to-black"></div>
                <div className="container mx-auto px-6 relative z-10">
                    <div className="flex flex-col lg:flex-row items-center gap-16 lg:gap-24">
                         <div className="w-full lg:w-1/2 relative order-2 lg:order-2">
                            <div className="relative aspect-square md:aspect-[4/3] bg-zinc-900/50 border border-white/10 rounded-xl overflow-hidden flex items-center justify-center group-hover:border-white/20 transition-all duration-500 cursor-pointer" onClick={() => setView('customizer')}>
                                <img src="https://images.unsplash.com/photo-1521572163474-6864f9cf17ab?q=80&w=800&auto=format&fit=crop" className="w-3/4 h-auto object-contain relative z-10 mix-blend-luminosity group-hover:mix-blend-normal transition-all duration-700" alt="Custom Tee" />
                                <div className="absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-transparent"></div>
                                <div className="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-20"><div className="w-20 h-20 bg-white/10 backdrop-blur-md rounded-full flex items-center justify-center border border-white/30 group-hover:scale-110 transition-transform duration-300"><Wand className="w-8 h-8 text-white" /></div></div>
                                <div className="absolute bottom-6 left-6 right-6 flex justify-between items-end"><div><p className="font-mono text-[10px] text-gray-400 uppercase tracking-widest mb-1">Status</p><p className="font-syne text-white font-bold text-lg uppercase flex items-center gap-2"><span className="w-2 h-2 bg-green-500 rounded-full animate-pulse"></span> Ready to Build</p></div></div>
                            </div>
                            <div className="absolute -top-4 -right-4 w-24 h-24 border-t-2 border-r-2 border-red-600 opacity-50"></div><div className="absolute -bottom-4 -left-4 w-24 h-24 border-b-2 border-l-2 border-red-600 opacity-50"></div>
                        </div>
                        <div className="w-full lg:w-1/2 order-1 lg:order-1 text-center lg:text-left">
                            <div className="inline-flex items-center gap-2 px-3 py-1 border border-white/20 rounded-full mb-6 bg-white/5 backdrop-blur-sm"><span className="w-1.5 h-1.5 bg-red-500 rounded-full animate-pulse"></span><span className="text-[10px] font-bold text-white tracking-[0.2em] uppercase">The Workshop</span></div>
                            <h2 className="font-syne font-black text-5xl md:text-7xl text-white uppercase leading-[0.9] mb-6 tracking-tighter">Design Your<br/><span className="text-transparent bg-clip-text bg-gradient-to-r from-white via-gray-400 to-gray-600">Own Gear</span></h2>
                            <p className="text-gray-400 text-sm md:text-base font-light leading-relaxed mb-10 max-w-lg mx-auto lg:mx-0">Step into the Fabrication Lab. Select your base, apply custom graphics, and tweak the color spectrum. Create a 1-of-1 piece that defines your style.</p>
                            <div className="flex flex-col sm:flex-row items-center gap-4 justify-center lg:justify-start"><button onClick={() => setView('customizer')} className="w-full sm:w-auto px-8 py-4 bg-white text-black font-bold text-xs uppercase tracking-[0.2em] hover:bg-red-600 hover:text-white transition-all duration-300 flex items-center justify-center gap-3 group/btn">Start Customizing<ArrowRight className="w-4 h-4 group-hover/btn:translate-x-1 transition-transform" /></button><span className="text-[10px] text-gray-500 font-mono uppercase tracking-widest">~ 5 min session</span></div>
                        </div>
                    </div>
                </div>
            </section>
        );

        const App = () => {
            const [isLoading, setIsLoading] = useState(true); 
            const [currentView, setCurrentView] = useState('home');
            const [cart, setCart] = useState([]);
            const [isCartOpen, setIsCartOpen] = useState(false);
            const [selectedProduct, setSelectedProduct] = useState(null);

            useEffect(() => { preloadImages([SITE_CONFIG.logoUrl, ...LOADING_IMAGES]); }, []);

            const addToCart = (productWithSize) => { setCart([...cart, productWithSize]); setIsCartOpen(true); };
            const removeFromCart = (indexToRemove) => { setCart(cart.filter((_, index) => index !== indexToRemove)); };
            const goToCheckout = () => { setIsCartOpen(false); setCurrentView('checkout'); window.scrollTo(0, 0); };

            if (currentView === 'customizer') return <div className="bg-black min-h-screen text-white"><CustomizerStudio addToCart={addToCart} goBack={() => setCurrentView('home')} /></div>;

            const getFilteredProducts = () => { 
                if (currentView === 'home') return PRODUCTS;
                if (currentView === 'new_drops') return PRODUCTS.filter(p => p.badge === 'NEW' || p.category === 'new_drops');
                return PRODUCTS.filter(p => p.category === currentView); 
            };

            return (
                <div className="bg-black min-h-screen text-slate-200 font-sans selection:bg-red-500 selection:text-white">
                    {isLoading && <LoadingScreen onComplete={() => setIsLoading(false)} />}
                    <SmoothSnow />
                    <header className="fixed w-full top-0 z-50"><HolidayBanner /><Navbar cartCount={cart.length} setView={setCurrentView} currentView={currentView} toggleCart={() => setIsCartOpen(true)} /></header>
                    <CartDrawer isOpen={isCartOpen} close={() => setIsCartOpen(false)} cart={cart} removeFromCart={removeFromCart} goToCheckout={goToCheckout} />
                    {selectedProduct && <ProductModal product={selectedProduct} close={() => setSelectedProduct(null)} addToCart={addToCart} goToCheckout={goToCheckout} />}
                    
                    {currentView === 'checkout' ? <CheckoutPage cart={cart} setView={setCurrentView} /> : 
                     currentView === 'vision' ? <VisionPage /> : 
                     currentView === 'support' ? <CustomerCarePage /> : 
                     currentView === 'success' ? <PaymentSuccess setView={setCurrentView} /> : 
                     currentView === 'failed' ? <PaymentFailed setView={setCurrentView} /> : 
                     (
                        <main className="pt-32"> 
                            {currentView === 'home' && <Hero setView={setCurrentView} />}
                            {currentView === 'home' && <CuratedRail setView={setCurrentView} />}
                            <div className="container mx-auto px-6 py-16 md:py-32">
                                <div className="text-center mb-12 md:mb-20">
                                    <span className="text-red-600 font-mono text-[10px] tracking-[0.3em] uppercase block mb-4">{currentView === 'new_drops' ? 'New Arrivals' : 'Winter 2025'}</span>
                                    <h2 className="font-syne text-3xl md:text-5xl font-bold text-white uppercase">{currentView === 'home' ? 'Trending Now' : (currentView === 'new_drops' ? 'The Drop' : `${currentView} Collection`)}</h2>
                                </div>
                                <div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 md:gap-6 gap-y-10 max-w-7xl mx-auto">
                                    {getFilteredProducts().map((product) => <ProductCard key={product.id} product={product} openModal={setSelectedProduct} />)}
                                </div>
                                {getFilteredProducts().length === 0 && <div className="text-center text-gray-500 py-12"><p>No products found in this selection.</p></div>}
                            </div>
                            
                            {currentView === 'home' && <TheFashionFrontier setView={setCurrentView} />}
                            
                            {currentView === 'home' && <MaterialInnovation />}
                            {currentView === 'home' && <TheVault addToCart={addToCart} />}
                            {currentView === 'home' && <CustomizerTeaser setView={setCurrentView} />}
                        </main>
                    )}
                    <footer className="bg-[#050505] border-t border-white/5 pt-16 md:pt-32 pb-16 px-6">
                        <div className="container mx-auto grid grid-cols-1 md:grid-cols-4 gap-12 md:gap-16 mb-24 max-w-7xl">
                            <div><img src={SITE_CONFIG.logoUrl} alt="Logo" onError={(e) => { e.target.src = 'https://placehold.co/200x50/000/fff?text=DRIFT+N+THREADS'; }} className="h-20 md:h-32 object-contain mb-8" /></div>
                            <div><h4 className="text-white font-bold tracking-widest mb-8 text-[10px] uppercase">Collections</h4><ul className="space-y-4 text-gray-500 text-xs uppercase tracking-wider"><li>Ready-to-Wear</li><li>Accessories</li><li>Footwear</li><li>Archive</li></ul></div>
                            <div><h4 className="text-white font-bold tracking-widest mb-8 text-[10px] uppercase">Client Services</h4><ul className="space-y-4 text-gray-500 text-xs uppercase tracking-wider"><li>Shipping & Returns</li><li>Size Guide</li><li>Care Instructions</li><li>Contact Us</li></ul></div>
                            <div><h4 className="text-white font-bold tracking-widest mb-8 text-[10px] uppercase">Newsletter</h4><div className="flex border-b border-white/20 pb-4"><input type="email" placeholder="EMAIL ADDRESS" className="bg-transparent w-full text-white outline-none placeholder-gray-600 text-xs tracking-widest uppercase" /><ArrowRight className="text-white cursor-pointer hover:text-red-500 transition-colors w-4 h-4" /></div></div>
                        </div>
                        <div className="container mx-auto max-w-7xl flex flex-col md:flex-row justify-between items-center text-[10px] text-gray-700 uppercase tracking-widest"><p>&copy; 2025 {SITE_CONFIG.brandName}. All Rights Reserved.</p><div className="flex space-x-6 mt-4 md:mt-0"><span>Privacy Policy</span><span>Terms of Use</span></div></div>
                    </footer>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>